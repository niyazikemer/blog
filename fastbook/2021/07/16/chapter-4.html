<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Chapter 4 - Under the Hood - Training a Digit Classifier | Niyazi Kemer</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Chapter 4 - Under the Hood - Training a Digit Classifier" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Deep Learning For Coders with fastai &amp; Pytorch - Under the Hood - Training a Digit Classifier. In this notebook. I add some cells for utility fuctions. path, ls, untar, !, tree usage, as usual I followed both Jeremy Howard’s Lesson and Weights and Biases reading group videos. Click open in colab button at the right side to view as notebook." />
<meta property="og:description" content="Deep Learning For Coders with fastai &amp; Pytorch - Under the Hood - Training a Digit Classifier. In this notebook. I add some cells for utility fuctions. path, ls, untar, !, tree usage, as usual I followed both Jeremy Howard’s Lesson and Weights and Biases reading group videos. Click open in colab button at the right side to view as notebook." />
<link rel="canonical" href="https://niyazikemer.com/fastbook/2021/07/16/chapter-4.html" />
<meta property="og:url" content="https://niyazikemer.com/fastbook/2021/07/16/chapter-4.html" />
<meta property="og:site_name" content="Niyazi Kemer" />
<meta property="og:image" content="https://niyazikemer.com/images/magpie.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-07-16T00:00:00-05:00" />
<script type="application/ld+json">
{"datePublished":"2021-07-16T00:00:00-05:00","url":"https://niyazikemer.com/fastbook/2021/07/16/chapter-4.html","@type":"BlogPosting","image":"https://niyazikemer.com/images/magpie.png","headline":"Chapter 4 - Under the Hood - Training a Digit Classifier","dateModified":"2021-07-16T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://niyazikemer.com/fastbook/2021/07/16/chapter-4.html"},"description":"Deep Learning For Coders with fastai &amp; Pytorch - Under the Hood - Training a Digit Classifier. In this notebook. I add some cells for utility fuctions. path, ls, untar, !, tree usage, as usual I followed both Jeremy Howard’s Lesson and Weights and Biases reading group videos. Click open in colab button at the right side to view as notebook.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://niyazikemer.com/feed.xml" title="Niyazi Kemer" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Niyazi Kemer</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Chapter 4 - Under the Hood - Training a Digit  Classifier</h1><p class="page-description">Deep Learning For Coders with fastai & Pytorch - Under the Hood - Training a Digit Classifier. In this notebook. I add some cells for utility fuctions. `path`, `ls`, `untar`, `!`, `tree` usage, as usual I followed both Jeremy Howard's Lesson and Weights and Biases reading group videos. Click `open in colab` button at the right side to view as notebook.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-07-16T00:00:00-05:00" itemprop="datePublished">
        Jul 16, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      19 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#fastbook">fastbook</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/niyazikemer/blog/tree/master/_notebooks/2021-07-16-chapter-4.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/niyazikemer/blog/master?filepath=_notebooks%2F2021-07-16-chapter-4.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/niyazikemer/blog/blob/master/_notebooks/2021-07-16-chapter-4.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#EXPLORING-THE-DATASET">EXPLORING THE DATASET </a>
<ul>
<li class="toc-entry toc-h3"><a href="#What-untar-does?">What untar does? </a></li>
<li class="toc-entry toc-h3"><a href="#What-is-path-?">What is path ? </a></li>
<li class="toc-entry toc-h3"><a href="#What-is-!ls-?">What is !ls ? </a></li>
<li class="toc-entry toc-h3"><a href="#What-is-tree-?">What is tree ? </a></li>
<li class="toc-entry toc-h3"><a href="#What-is-ls()-?">What is ls() ? </a></li>
<li class="toc-entry toc-h3"><a href="#What-is-PIL-?-(Python-Image-Library)">What is PIL ? (Python Image Library) </a></li>
<li class="toc-entry toc-h3"><a href="#NumPy-array">NumPy array </a></li>
<li class="toc-entry toc-h3"><a href="#Pytorch-tensor">Pytorch tensor </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#BASELINE:-Pixel-similarity">BASELINE: Pixel similarity </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Training-Set:--Stacking-Tensors">Training Set:  Stacking Tensors </a></li>
<li class="toc-entry toc-h3"><a href="#Mean-of-threes-and-sevens-our-ideal-3-and-7.">Mean of threes and sevens our ideal 3 and 7. </a></li>
<li class="toc-entry toc-h3"><a href="#Distance-between-the-ideal-three-and-other-threes">Distance between the ideal three and other threes </a></li>
<li class="toc-entry toc-h3"><a href="#Pytorch-L1-and-MSE-fuctions">Pytorch L1 and MSE fuctions </a></li>
<li class="toc-entry toc-h3"><a href="#Array-and-Tensor-Examples">Array and Tensor Examples </a>
<ul>
<li class="toc-entry toc-h4"><a href="#Splitting,-adding,-multiplying-tensors">Splitting, adding, multiplying tensors </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#Validation-set-:Stacking-Tensors">Validation set :Stacking Tensors </a></li>
<li class="toc-entry toc-h3"><a href="#Manual-L1-distance-function">Manual L1 distance function </a></li>
<li class="toc-entry toc-h3"><a href="#This-is-broadcasting:">This is broadcasting: </a>
<ul>
<li class="toc-entry toc-h4"><a href="#here-is-an-another-broadcasting-for-all-validation-set:">here is an another broadcasting for all validation set: </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#Accuracy-of-our-'ideal'-3-and-7">Accuracy of our &#39;ideal&#39; 3 and 7 </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#STOCHASTIC-GRADIENT-DECENT-(SGD)">STOCHASTIC GRADIENT DECENT (SGD) </a>
<ul>
<li class="toc-entry toc-h3"><a href="#GD-example">GD example </a></li>
<li class="toc-entry toc-h3"><a href="#How-to-calculate-gradient:">How to calculate gradient: </a></li>
<li class="toc-entry toc-h3"><a href="#End-to-end-SGD-example">End to end SGD example </a>
<ul>
<li class="toc-entry toc-h4"><a href="#Step-1:-here-are-initial-random-parameters:">Step 1: here are initial random parameters: </a></li>
<li class="toc-entry toc-h4"><a href="#Step-2:-calculate-predictions:">Step 2: calculate predictions: </a></li>
<li class="toc-entry toc-h4"><a href="#Step-3:-Calculate-the-loss">Step 3: Calculate the loss </a></li>
<li class="toc-entry toc-h4"><a href="#Step-4:-first-we-calculate-the-gradient:">Step 4: first we calculate the gradient: </a></li>
<li class="toc-entry toc-h4"><a href="#Step-5:-Step-the-weight.">Step 5: Step the weight. </a></li>
<li class="toc-entry toc-h4"><a href="#Step-6:-repeat-the-step:">Step 6: repeat the step: </a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#MNIST">MNIST </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Loss-Function-our-3-and-7-recognizer.-Currently-we-use-metric-not-loss">Loss Function our 3 and 7 recognizer. Currently we use metric not loss </a></li>
<li class="toc-entry toc-h3"><a href="#How-tensor-manipulated">How tensor manipulated </a></li>
<li class="toc-entry toc-h3"><a href="#How-unsqueeze-works?">How unsqueeze works? </a></li>
<li class="toc-entry toc-h3"><a href="#Dataset">Dataset </a></li>
<li class="toc-entry toc-h3"><a href="#Weights">Weights </a></li>
<li class="toc-entry toc-h3"><a href="#Why-we-need-a-loss-Function">Why we need a loss Function </a></li>
<li class="toc-entry toc-h3"><a href="#Sigmoid">Sigmoid </a></li>
<li class="toc-entry toc-h3"><a href="#What-are-SGD-and-Mini-Batches">What are SGD and Mini-Batches </a>
<ul>
<li class="toc-entry toc-h4"><a href="#DataLoader">DataLoader </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#Training">Training </a></li>
<li class="toc-entry toc-h3"><a href="#Optimizer">Optimizer </a></li>
<li class="toc-entry toc-h3"><a href="#Fastai's-SDG-class">Fastai&#39;s SDG class </a>
<ul>
<li class="toc-entry toc-h4"><a href="#Fastai's-Dataloaders">Fastai&#39;s Dataloaders </a></li>
<li class="toc-entry toc-h4"><a href="#FastAi's-Fit">FastAi&#39;s Fit </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#Adding-a-Nonlinearity">Adding a Nonlinearity </a>
<ul>
<li class="toc-entry toc-h4"><a href="#recorder-is-a-fast-ai-method">recorder is a fast ai method </a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#GOING-DEEPER">GOING DEEPER </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-07-16-chapter-4.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/images/copied_from_nb/images/chapter-04/magpie.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>I found this little one in front of my window. Suffering from foot deformity and can't fly. Now fully recovered and back his/her family.</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">fastbook</span>
<span class="n">fastbook</span><span class="o">.</span><span class="n">setup_book</span><span class="p">()</span>
<span class="c1"># below is for disabling Jedi autocomplete that doesn't work well.</span>
<span class="o">%</span><span class="k">config</span> Completer.use_jedi = False
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastbook</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">'image'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'Greys'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="EXPLORING-THE-DATASET">
<a class="anchor" href="#EXPLORING-THE-DATASET" aria-hidden="true"><span class="octicon octicon-link"></span></a>EXPLORING THE DATASET<a class="anchor-link" href="#EXPLORING-THE-DATASET"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="What-untar-does?">
<a class="anchor" href="#What-untar-does?" aria-hidden="true"><span class="octicon octicon-link"></span></a>What untar does?<a class="anchor-link" href="#What-untar-does?"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>’untar_data’ come from fastai library, it downloads the data and untar it if it didn’t already and returns the destination folder.
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_SAMPLE</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">??</span>untar_data
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-success">
    <svg class="octicon octicon-checklist octicon octicon-checklist" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M2.5 1.75a.25.25 0 01.25-.25h8.5a.25.25 0 01.25.25v7.736a.75.75 0 101.5 0V1.75A1.75 1.75 0 0011.25 0h-8.5A1.75 1.75 0 001 1.75v11.5c0 .966.784 1.75 1.75 1.75h3.17a.75.75 0 000-1.5H2.75a.25.25 0 01-.25-.25V1.75zM4.75 4a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-4.5zM4 7.75A.75.75 0 014.75 7h2a.75.75 0 010 1.5h-2A.75.75 0 014 7.75zm11.774 3.537a.75.75 0 00-1.048-1.074L10.7 14.145 9.281 12.72a.75.75 0 00-1.062 1.058l1.943 1.95a.75.75 0 001.055.008l4.557-4.45z"></path></svg>
    <strong>Tip: </strong>Check it with ’??’
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="What-is-path-?">
<a class="anchor" href="#What-is-path-?" aria-hidden="true"><span class="octicon octicon-link"></span></a>What is path ?<a class="anchor-link" href="#What-is-path-?"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path('.')</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-success">
    <svg class="octicon octicon-checklist octicon octicon-checklist octicon octicon-checklist" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M2.5 1.75a.25.25 0 01.25-.25h8.5a.25.25 0 01.25.25v7.736a.75.75 0 101.5 0V1.75A1.75 1.75 0 0011.25 0h-8.5A1.75 1.75 0 001 1.75v11.5c0 .966.784 1.75 1.75 1.75h3.17a.75.75 0 000-1.5H2.75a.25.25 0 01-.25-.25V1.75zM4.75 4a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-4.5zM4 7.75A.75.75 0 014.75 7h2a.75.75 0 010 1.5h-2A.75.75 0 014 7.75zm11.774 3.537a.75.75 0 00-1.048-1.074L10.7 14.145 9.281 12.72a.75.75 0 00-1.062 1.058l1.943 1.95a.75.75 0 001.055.008l4.557-4.45z"></path></svg>
    <strong>Tip: </strong>what is inside the current folder? this where the jupyter notebook works. ’!’ at the beginning means the command works on the terminal.
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="What-is-!ls-?">
<a class="anchor" href="#What-is-!ls-?" aria-hidden="true"><span class="octicon octicon-link"></span></a>What is !ls ?<a class="anchor-link" href="#What-is-!ls-?"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong><strong>ls works on the terminal. (-d for only listing directories)</strong>
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2020-02-20-test.ipynb	    ghtop_images  my_icons
2021-07-16-chapter-4.ipynb  images	  README.md
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>can be used like this too.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls /home/niyazi/.fastai/data/mnist_sample/train -d
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/home/niyazi/.fastai/data/mnist_sample/train
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>also like this:</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls /home/niyazi/.fastai/data/mnist_sample/train/3 -d
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/home/niyazi/.fastai/data/mnist_sample/train/3
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="What-is-tree-?">
<a class="anchor" href="#What-is-tree-?" aria-hidden="true"><span class="octicon octicon-link"></span></a>What is tree ?<a class="anchor-link" href="#What-is-tree-?"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong><strong>for seeing tree sturucture of the files and folders (-d argument for directories)</strong>
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>tree /home/niyazi/.fastai/data/mnist_sample/ -d
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-intense-fg ansi-bold">/home/niyazi/.fastai/data/mnist_sample/</span>
├── <span class="ansi-blue-intense-fg ansi-bold">train</span>
│   ├── <span class="ansi-blue-intense-fg ansi-bold">3</span>
│   └── <span class="ansi-blue-intense-fg ansi-bold">7</span>
└── <span class="ansi-blue-intense-fg ansi-bold">valid</span>
    ├── <span class="ansi-blue-intense-fg ansi-bold">3</span>
    └── <span class="ansi-blue-intense-fg ansi-bold">7</span>

6 directories
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Path</span><span class="o">.</span><span class="n">BASE_PATH</span> <span class="o">=</span> <span class="n">path</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="What-is-ls()-?">
<a class="anchor" href="#What-is-ls()-?" aria-hidden="true"><span class="octicon octicon-link"></span></a>What is ls() ?<a class="anchor-link" href="#What-is-ls()-?"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>’ls’ is method by fastai similiar the Python’s list fuction but more powerful.
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#3) [Path('labels.csv'),Path('train'),Path('valid')]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>Check this usage:
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'train'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path('train')</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'train'</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#2) [Path('train/7'),Path('train/3')]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>there are  two folders under training folder
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">threes</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'train'</span><span class="o">/</span><span class="s1">'3'</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">sevens</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'train'</span><span class="o">/</span><span class="s1">'7'</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>this code returns and ordered list of paths
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="What-is-PIL-?-(Python-Image-Library)">
<a class="anchor" href="#What-is-PIL-?-(Python-Image-Library)" aria-hidden="true"><span class="octicon octicon-link"></span></a>What is PIL ? (Python Image Library)<a class="anchor-link" href="#What-is-PIL-?-(Python-Image-Library)"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">im3_path</span> <span class="o">=</span> <span class="n">threes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">im3</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">im3_path</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">im3</span><span class="p">)</span>
<span class="c1">#im3</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>PIL.PngImagePlugin.PngImageFile</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="NumPy-array">
<a class="anchor" href="#NumPy-array" aria-hidden="true"><span class="octicon octicon-link"></span></a>NumPy array<a class="anchor-link" href="#NumPy-array"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The 4:10 indicates we requested the rows from index 4 (included) to 10 (not included) and the same for the columns. NumPy indexes from top to bottom and left to right, so this section is located in the top-left corner of the image.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">array</span><span class="p">(</span><span class="n">im3</span><span class="p">)[</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[  0,   0,   0,   0,   0,   0],
       [  0,   0,   0,   0,   0,  29],
       [  0,   0,   0,  48, 166, 224],
       [  0,  93, 244, 249, 253, 187],
       [  0, 107, 253, 253, 230,  48],
       [  0,   3,  20,  20,  15,   0]], dtype=uint8)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>this is how it looks  some part of the image in the NumPy array
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Pytorch-tensor">
<a class="anchor" href="#Pytorch-tensor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pytorch tensor<a class="anchor-link" href="#Pytorch-tensor"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's the same thing as a PyTorch tensor:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tensor</span><span class="p">(</span><span class="n">im3</span><span class="p">)[</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[  0,   0,   0,   0,   0,   0],
        [  0,   0,   0,   0,   0,  29],
        [  0,   0,   0,  48, 166, 224],
        [  0,  93, 244, 249, 253, 187],
        [  0, 107, 253, 253, 230,  48],
        [  0,   3,  20,  20,  15,   0]], dtype=torch.uint8)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>It is possible to convert it to a tansor as well.
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">im3_t</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">im3</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">im3_t</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">22</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">'font-size'</span><span class="p">:</span><span class="s1">'6pt'</span><span class="p">})</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="s1">'OrRd'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style type="text/css">
#T_cef29_row0_col0,#T_cef29_row0_col1,#T_cef29_row0_col2,#T_cef29_row0_col3,#T_cef29_row0_col4,#T_cef29_row0_col5,#T_cef29_row0_col6,#T_cef29_row0_col7,#T_cef29_row0_col8,#T_cef29_row0_col9,#T_cef29_row0_col10,#T_cef29_row0_col11,#T_cef29_row0_col12,#T_cef29_row0_col13,#T_cef29_row0_col14,#T_cef29_row0_col15,#T_cef29_row0_col16,#T_cef29_row0_col17,#T_cef29_row1_col0,#T_cef29_row1_col1,#T_cef29_row1_col2,#T_cef29_row1_col3,#T_cef29_row1_col4,#T_cef29_row1_col15,#T_cef29_row1_col16,#T_cef29_row1_col17,#T_cef29_row2_col0,#T_cef29_row2_col1,#T_cef29_row2_col2,#T_cef29_row2_col15,#T_cef29_row2_col16,#T_cef29_row2_col17,#T_cef29_row3_col0,#T_cef29_row3_col15,#T_cef29_row3_col16,#T_cef29_row3_col17,#T_cef29_row4_col0,#T_cef29_row4_col6,#T_cef29_row4_col7,#T_cef29_row4_col8,#T_cef29_row4_col9,#T_cef29_row4_col10,#T_cef29_row4_col15,#T_cef29_row4_col16,#T_cef29_row4_col17,#T_cef29_row5_col0,#T_cef29_row5_col5,#T_cef29_row5_col6,#T_cef29_row5_col7,#T_cef29_row5_col8,#T_cef29_row5_col9,#T_cef29_row5_col15,#T_cef29_row5_col16,#T_cef29_row5_col17,#T_cef29_row6_col0,#T_cef29_row6_col1,#T_cef29_row6_col2,#T_cef29_row6_col3,#T_cef29_row6_col4,#T_cef29_row6_col5,#T_cef29_row6_col6,#T_cef29_row6_col7,#T_cef29_row6_col8,#T_cef29_row6_col9,#T_cef29_row6_col14,#T_cef29_row6_col15,#T_cef29_row6_col16,#T_cef29_row6_col17,#T_cef29_row7_col0,#T_cef29_row7_col1,#T_cef29_row7_col2,#T_cef29_row7_col3,#T_cef29_row7_col4,#T_cef29_row7_col5,#T_cef29_row7_col6,#T_cef29_row7_col13,#T_cef29_row7_col14,#T_cef29_row7_col15,#T_cef29_row7_col16,#T_cef29_row7_col17,#T_cef29_row8_col0,#T_cef29_row8_col1,#T_cef29_row8_col2,#T_cef29_row8_col3,#T_cef29_row8_col4,#T_cef29_row8_col13,#T_cef29_row8_col14,#T_cef29_row8_col15,#T_cef29_row8_col16,#T_cef29_row8_col17,#T_cef29_row9_col0,#T_cef29_row9_col1,#T_cef29_row9_col2,#T_cef29_row9_col3,#T_cef29_row9_col4,#T_cef29_row9_col16,#T_cef29_row9_col17,#T_cef29_row10_col0,#T_cef29_row10_col1,#T_cef29_row10_col2,#T_cef29_row10_col3,#T_cef29_row10_col4,#T_cef29_row10_col5,#T_cef29_row10_col6,#T_cef29_row10_col17{
            font-size:  6pt;
            background-color:  #fff7ec;
            color:  #000000;
        }#T_cef29_row1_col5{
            font-size:  6pt;
            background-color:  #fee7c7;
            color:  #000000;
        }#T_cef29_row1_col6,#T_cef29_row1_col13{
            font-size:  6pt;
            background-color:  #f2704c;
            color:  #000000;
        }#T_cef29_row1_col7{
            font-size:  6pt;
            background-color:  #d12719;
            color:  #f1f1f1;
        }#T_cef29_row1_col8,#T_cef29_row1_col9,#T_cef29_row1_col10,#T_cef29_row2_col5,#T_cef29_row2_col6,#T_cef29_row2_col7,#T_cef29_row2_col11,#T_cef29_row2_col12,#T_cef29_row2_col13,#T_cef29_row3_col4,#T_cef29_row3_col12,#T_cef29_row3_col13,#T_cef29_row4_col1,#T_cef29_row4_col2,#T_cef29_row4_col3,#T_cef29_row4_col12,#T_cef29_row4_col13,#T_cef29_row5_col12,#T_cef29_row6_col11,#T_cef29_row9_col11,#T_cef29_row10_col11,#T_cef29_row10_col12,#T_cef29_row10_col13,#T_cef29_row10_col14,#T_cef29_row10_col15,#T_cef29_row10_col16{
            font-size:  6pt;
            background-color:  #7f0000;
            color:  #f1f1f1;
        }#T_cef29_row1_col11{
            font-size:  6pt;
            background-color:  #e14630;
            color:  #f1f1f1;
        }#T_cef29_row1_col12{
            font-size:  6pt;
            background-color:  #d32a1b;
            color:  #f1f1f1;
        }#T_cef29_row1_col14{
            font-size:  6pt;
            background-color:  #fdb982;
            color:  #000000;
        }#T_cef29_row2_col3{
            font-size:  6pt;
            background-color:  #fddeb3;
            color:  #000000;
        }#T_cef29_row2_col4,#T_cef29_row8_col6{
            font-size:  6pt;
            background-color:  #e9583e;
            color:  #000000;
        }#T_cef29_row2_col8,#T_cef29_row2_col14,#T_cef29_row3_col14{
            font-size:  6pt;
            background-color:  #a00000;
            color:  #f1f1f1;
        }#T_cef29_row2_col9,#T_cef29_row3_col11{
            font-size:  6pt;
            background-color:  #d2291a;
            color:  #f1f1f1;
        }#T_cef29_row2_col10,#T_cef29_row7_col10,#T_cef29_row8_col8,#T_cef29_row8_col10,#T_cef29_row9_col8,#T_cef29_row9_col10{
            font-size:  6pt;
            background-color:  #810000;
            color:  #f1f1f1;
        }#T_cef29_row3_col1{
            font-size:  6pt;
            background-color:  #b40201;
            color:  #f1f1f1;
        }#T_cef29_row3_col2{
            font-size:  6pt;
            background-color:  #8e0000;
            color:  #f1f1f1;
        }#T_cef29_row3_col3{
            font-size:  6pt;
            background-color:  #860000;
            color:  #f1f1f1;
        }#T_cef29_row3_col5{
            font-size:  6pt;
            background-color:  #be0f0a;
            color:  #f1f1f1;
        }#T_cef29_row3_col6{
            font-size:  6pt;
            background-color:  #fedfb5;
            color:  #000000;
        }#T_cef29_row3_col7,#T_cef29_row3_col10{
            font-size:  6pt;
            background-color:  #fff2e1;
            color:  #000000;
        }#T_cef29_row3_col8{
            font-size:  6pt;
            background-color:  #fff3e3;
            color:  #000000;
        }#T_cef29_row3_col9{
            font-size:  6pt;
            background-color:  #fff5e7;
            color:  #000000;
        }#T_cef29_row4_col4{
            font-size:  6pt;
            background-color:  #a50000;
            color:  #f1f1f1;
        }#T_cef29_row4_col5{
            font-size:  6pt;
            background-color:  #fddaab;
            color:  #000000;
        }#T_cef29_row4_col11{
            font-size:  6pt;
            background-color:  #d42c1c;
            color:  #f1f1f1;
        }#T_cef29_row4_col14{
            font-size:  6pt;
            background-color:  #f06849;
            color:  #000000;
        }#T_cef29_row5_col1{
            font-size:  6pt;
            background-color:  #fff4e4;
            color:  #000000;
        }#T_cef29_row5_col2,#T_cef29_row5_col3{
            font-size:  6pt;
            background-color:  #feeed5;
            color:  #000000;
        }#T_cef29_row5_col4{
            font-size:  6pt;
            background-color:  #fff0db;
            color:  #000000;
        }#T_cef29_row5_col10,#T_cef29_row10_col7{
            font-size:  6pt;
            background-color:  #fee1b9;
            color:  #000000;
        }#T_cef29_row5_col11{
            font-size:  6pt;
            background-color:  #ae0000;
            color:  #f1f1f1;
        }#T_cef29_row5_col13,#T_cef29_row6_col12{
            font-size:  6pt;
            background-color:  #8c0000;
            color:  #f1f1f1;
        }#T_cef29_row5_col14{
            font-size:  6pt;
            background-color:  #fdcc96;
            color:  #000000;
        }#T_cef29_row6_col10,#T_cef29_row7_col11,#T_cef29_row9_col6{
            font-size:  6pt;
            background-color:  #870000;
            color:  #f1f1f1;
        }#T_cef29_row6_col13{
            font-size:  6pt;
            background-color:  #fc8e5a;
            color:  #000000;
        }#T_cef29_row7_col7{
            font-size:  6pt;
            background-color:  #fff0dc;
            color:  #000000;
        }#T_cef29_row7_col8{
            font-size:  6pt;
            background-color:  #fdb37d;
            color:  #000000;
        }#T_cef29_row7_col9{
            font-size:  6pt;
            background-color:  #b30000;
            color:  #f1f1f1;
        }#T_cef29_row7_col12{
            font-size:  6pt;
            background-color:  #fc915c;
            color:  #000000;
        }#T_cef29_row8_col5{
            font-size:  6pt;
            background-color:  #fff1de;
            color:  #000000;
        }#T_cef29_row8_col7{
            font-size:  6pt;
            background-color:  #960000;
            color:  #f1f1f1;
        }#T_cef29_row8_col9,#T_cef29_row9_col9{
            font-size:  6pt;
            background-color:  #820000;
            color:  #f1f1f1;
        }#T_cef29_row8_col11{
            font-size:  6pt;
            background-color:  #d93422;
            color:  #f1f1f1;
        }#T_cef29_row8_col12{
            font-size:  6pt;
            background-color:  #fee9ca;
            color:  #000000;
        }#T_cef29_row9_col5{
            font-size:  6pt;
            background-color:  #feefd8;
            color:  #000000;
        }#T_cef29_row9_col7{
            font-size:  6pt;
            background-color:  #840000;
            color:  #f1f1f1;
        }#T_cef29_row9_col12{
            font-size:  6pt;
            background-color:  #a10000;
            color:  #f1f1f1;
        }#T_cef29_row9_col13{
            font-size:  6pt;
            background-color:  #bc0c08;
            color:  #f1f1f1;
        }#T_cef29_row9_col14{
            font-size:  6pt;
            background-color:  #fca36e;
            color:  #000000;
        }#T_cef29_row9_col15{
            font-size:  6pt;
            background-color:  #fff6ea;
            color:  #000000;
        }#T_cef29_row10_col8,#T_cef29_row10_col9{
            font-size:  6pt;
            background-color:  #fdb881;
            color:  #000000;
        }#T_cef29_row10_col10{
            font-size:  6pt;
            background-color:  #c3150e;
            color:  #f1f1f1;
        }</style>
<table id="T_cef29_">
<thead>    <tr>        <th class="blank level0"></th>        <th class="col_heading level0 col0">0</th>        <th class="col_heading level0 col1">1</th>        <th class="col_heading level0 col2">2</th>        <th class="col_heading level0 col3">3</th>        <th class="col_heading level0 col4">4</th>        <th class="col_heading level0 col5">5</th>        <th class="col_heading level0 col6">6</th>        <th class="col_heading level0 col7">7</th>        <th class="col_heading level0 col8">8</th>        <th class="col_heading level0 col9">9</th>        <th class="col_heading level0 col10">10</th>        <th class="col_heading level0 col11">11</th>        <th class="col_heading level0 col12">12</th>        <th class="col_heading level0 col13">13</th>        <th class="col_heading level0 col14">14</th>        <th class="col_heading level0 col15">15</th>        <th class="col_heading level0 col16">16</th>        <th class="col_heading level0 col17">17</th>    </tr>
</thead>
<tbody>
                <tr>
                        <th id="T_cef29_level0_row0" class="row_heading level0 row0">0</th>
                        <td id="T_cef29_row0_col0" class="data row0 col0">0</td>
                        <td id="T_cef29_row0_col1" class="data row0 col1">0</td>
                        <td id="T_cef29_row0_col2" class="data row0 col2">0</td>
                        <td id="T_cef29_row0_col3" class="data row0 col3">0</td>
                        <td id="T_cef29_row0_col4" class="data row0 col4">0</td>
                        <td id="T_cef29_row0_col5" class="data row0 col5">0</td>
                        <td id="T_cef29_row0_col6" class="data row0 col6">0</td>
                        <td id="T_cef29_row0_col7" class="data row0 col7">0</td>
                        <td id="T_cef29_row0_col8" class="data row0 col8">0</td>
                        <td id="T_cef29_row0_col9" class="data row0 col9">0</td>
                        <td id="T_cef29_row0_col10" class="data row0 col10">0</td>
                        <td id="T_cef29_row0_col11" class="data row0 col11">0</td>
                        <td id="T_cef29_row0_col12" class="data row0 col12">0</td>
                        <td id="T_cef29_row0_col13" class="data row0 col13">0</td>
                        <td id="T_cef29_row0_col14" class="data row0 col14">0</td>
                        <td id="T_cef29_row0_col15" class="data row0 col15">0</td>
                        <td id="T_cef29_row0_col16" class="data row0 col16">0</td>
                        <td id="T_cef29_row0_col17" class="data row0 col17">0</td>
            </tr>
            <tr>
                        <th id="T_cef29_level0_row1" class="row_heading level0 row1">1</th>
                        <td id="T_cef29_row1_col0" class="data row1 col0">0</td>
                        <td id="T_cef29_row1_col1" class="data row1 col1">0</td>
                        <td id="T_cef29_row1_col2" class="data row1 col2">0</td>
                        <td id="T_cef29_row1_col3" class="data row1 col3">0</td>
                        <td id="T_cef29_row1_col4" class="data row1 col4">0</td>
                        <td id="T_cef29_row1_col5" class="data row1 col5">29</td>
                        <td id="T_cef29_row1_col6" class="data row1 col6">150</td>
                        <td id="T_cef29_row1_col7" class="data row1 col7">195</td>
                        <td id="T_cef29_row1_col8" class="data row1 col8">254</td>
                        <td id="T_cef29_row1_col9" class="data row1 col9">255</td>
                        <td id="T_cef29_row1_col10" class="data row1 col10">254</td>
                        <td id="T_cef29_row1_col11" class="data row1 col11">176</td>
                        <td id="T_cef29_row1_col12" class="data row1 col12">193</td>
                        <td id="T_cef29_row1_col13" class="data row1 col13">150</td>
                        <td id="T_cef29_row1_col14" class="data row1 col14">96</td>
                        <td id="T_cef29_row1_col15" class="data row1 col15">0</td>
                        <td id="T_cef29_row1_col16" class="data row1 col16">0</td>
                        <td id="T_cef29_row1_col17" class="data row1 col17">0</td>
            </tr>
            <tr>
                        <th id="T_cef29_level0_row2" class="row_heading level0 row2">2</th>
                        <td id="T_cef29_row2_col0" class="data row2 col0">0</td>
                        <td id="T_cef29_row2_col1" class="data row2 col1">0</td>
                        <td id="T_cef29_row2_col2" class="data row2 col2">0</td>
                        <td id="T_cef29_row2_col3" class="data row2 col3">48</td>
                        <td id="T_cef29_row2_col4" class="data row2 col4">166</td>
                        <td id="T_cef29_row2_col5" class="data row2 col5">224</td>
                        <td id="T_cef29_row2_col6" class="data row2 col6">253</td>
                        <td id="T_cef29_row2_col7" class="data row2 col7">253</td>
                        <td id="T_cef29_row2_col8" class="data row2 col8">234</td>
                        <td id="T_cef29_row2_col9" class="data row2 col9">196</td>
                        <td id="T_cef29_row2_col10" class="data row2 col10">253</td>
                        <td id="T_cef29_row2_col11" class="data row2 col11">253</td>
                        <td id="T_cef29_row2_col12" class="data row2 col12">253</td>
                        <td id="T_cef29_row2_col13" class="data row2 col13">253</td>
                        <td id="T_cef29_row2_col14" class="data row2 col14">233</td>
                        <td id="T_cef29_row2_col15" class="data row2 col15">0</td>
                        <td id="T_cef29_row2_col16" class="data row2 col16">0</td>
                        <td id="T_cef29_row2_col17" class="data row2 col17">0</td>
            </tr>
            <tr>
                        <th id="T_cef29_level0_row3" class="row_heading level0 row3">3</th>
                        <td id="T_cef29_row3_col0" class="data row3 col0">0</td>
                        <td id="T_cef29_row3_col1" class="data row3 col1">93</td>
                        <td id="T_cef29_row3_col2" class="data row3 col2">244</td>
                        <td id="T_cef29_row3_col3" class="data row3 col3">249</td>
                        <td id="T_cef29_row3_col4" class="data row3 col4">253</td>
                        <td id="T_cef29_row3_col5" class="data row3 col5">187</td>
                        <td id="T_cef29_row3_col6" class="data row3 col6">46</td>
                        <td id="T_cef29_row3_col7" class="data row3 col7">10</td>
                        <td id="T_cef29_row3_col8" class="data row3 col8">8</td>
                        <td id="T_cef29_row3_col9" class="data row3 col9">4</td>
                        <td id="T_cef29_row3_col10" class="data row3 col10">10</td>
                        <td id="T_cef29_row3_col11" class="data row3 col11">194</td>
                        <td id="T_cef29_row3_col12" class="data row3 col12">253</td>
                        <td id="T_cef29_row3_col13" class="data row3 col13">253</td>
                        <td id="T_cef29_row3_col14" class="data row3 col14">233</td>
                        <td id="T_cef29_row3_col15" class="data row3 col15">0</td>
                        <td id="T_cef29_row3_col16" class="data row3 col16">0</td>
                        <td id="T_cef29_row3_col17" class="data row3 col17">0</td>
            </tr>
            <tr>
                        <th id="T_cef29_level0_row4" class="row_heading level0 row4">4</th>
                        <td id="T_cef29_row4_col0" class="data row4 col0">0</td>
                        <td id="T_cef29_row4_col1" class="data row4 col1">107</td>
                        <td id="T_cef29_row4_col2" class="data row4 col2">253</td>
                        <td id="T_cef29_row4_col3" class="data row4 col3">253</td>
                        <td id="T_cef29_row4_col4" class="data row4 col4">230</td>
                        <td id="T_cef29_row4_col5" class="data row4 col5">48</td>
                        <td id="T_cef29_row4_col6" class="data row4 col6">0</td>
                        <td id="T_cef29_row4_col7" class="data row4 col7">0</td>
                        <td id="T_cef29_row4_col8" class="data row4 col8">0</td>
                        <td id="T_cef29_row4_col9" class="data row4 col9">0</td>
                        <td id="T_cef29_row4_col10" class="data row4 col10">0</td>
                        <td id="T_cef29_row4_col11" class="data row4 col11">192</td>
                        <td id="T_cef29_row4_col12" class="data row4 col12">253</td>
                        <td id="T_cef29_row4_col13" class="data row4 col13">253</td>
                        <td id="T_cef29_row4_col14" class="data row4 col14">156</td>
                        <td id="T_cef29_row4_col15" class="data row4 col15">0</td>
                        <td id="T_cef29_row4_col16" class="data row4 col16">0</td>
                        <td id="T_cef29_row4_col17" class="data row4 col17">0</td>
            </tr>
            <tr>
                        <th id="T_cef29_level0_row5" class="row_heading level0 row5">5</th>
                        <td id="T_cef29_row5_col0" class="data row5 col0">0</td>
                        <td id="T_cef29_row5_col1" class="data row5 col1">3</td>
                        <td id="T_cef29_row5_col2" class="data row5 col2">20</td>
                        <td id="T_cef29_row5_col3" class="data row5 col3">20</td>
                        <td id="T_cef29_row5_col4" class="data row5 col4">15</td>
                        <td id="T_cef29_row5_col5" class="data row5 col5">0</td>
                        <td id="T_cef29_row5_col6" class="data row5 col6">0</td>
                        <td id="T_cef29_row5_col7" class="data row5 col7">0</td>
                        <td id="T_cef29_row5_col8" class="data row5 col8">0</td>
                        <td id="T_cef29_row5_col9" class="data row5 col9">0</td>
                        <td id="T_cef29_row5_col10" class="data row5 col10">43</td>
                        <td id="T_cef29_row5_col11" class="data row5 col11">224</td>
                        <td id="T_cef29_row5_col12" class="data row5 col12">253</td>
                        <td id="T_cef29_row5_col13" class="data row5 col13">245</td>
                        <td id="T_cef29_row5_col14" class="data row5 col14">74</td>
                        <td id="T_cef29_row5_col15" class="data row5 col15">0</td>
                        <td id="T_cef29_row5_col16" class="data row5 col16">0</td>
                        <td id="T_cef29_row5_col17" class="data row5 col17">0</td>
            </tr>
            <tr>
                        <th id="T_cef29_level0_row6" class="row_heading level0 row6">6</th>
                        <td id="T_cef29_row6_col0" class="data row6 col0">0</td>
                        <td id="T_cef29_row6_col1" class="data row6 col1">0</td>
                        <td id="T_cef29_row6_col2" class="data row6 col2">0</td>
                        <td id="T_cef29_row6_col3" class="data row6 col3">0</td>
                        <td id="T_cef29_row6_col4" class="data row6 col4">0</td>
                        <td id="T_cef29_row6_col5" class="data row6 col5">0</td>
                        <td id="T_cef29_row6_col6" class="data row6 col6">0</td>
                        <td id="T_cef29_row6_col7" class="data row6 col7">0</td>
                        <td id="T_cef29_row6_col8" class="data row6 col8">0</td>
                        <td id="T_cef29_row6_col9" class="data row6 col9">0</td>
                        <td id="T_cef29_row6_col10" class="data row6 col10">249</td>
                        <td id="T_cef29_row6_col11" class="data row6 col11">253</td>
                        <td id="T_cef29_row6_col12" class="data row6 col12">245</td>
                        <td id="T_cef29_row6_col13" class="data row6 col13">126</td>
                        <td id="T_cef29_row6_col14" class="data row6 col14">0</td>
                        <td id="T_cef29_row6_col15" class="data row6 col15">0</td>
                        <td id="T_cef29_row6_col16" class="data row6 col16">0</td>
                        <td id="T_cef29_row6_col17" class="data row6 col17">0</td>
            </tr>
            <tr>
                        <th id="T_cef29_level0_row7" class="row_heading level0 row7">7</th>
                        <td id="T_cef29_row7_col0" class="data row7 col0">0</td>
                        <td id="T_cef29_row7_col1" class="data row7 col1">0</td>
                        <td id="T_cef29_row7_col2" class="data row7 col2">0</td>
                        <td id="T_cef29_row7_col3" class="data row7 col3">0</td>
                        <td id="T_cef29_row7_col4" class="data row7 col4">0</td>
                        <td id="T_cef29_row7_col5" class="data row7 col5">0</td>
                        <td id="T_cef29_row7_col6" class="data row7 col6">0</td>
                        <td id="T_cef29_row7_col7" class="data row7 col7">14</td>
                        <td id="T_cef29_row7_col8" class="data row7 col8">101</td>
                        <td id="T_cef29_row7_col9" class="data row7 col9">223</td>
                        <td id="T_cef29_row7_col10" class="data row7 col10">253</td>
                        <td id="T_cef29_row7_col11" class="data row7 col11">248</td>
                        <td id="T_cef29_row7_col12" class="data row7 col12">124</td>
                        <td id="T_cef29_row7_col13" class="data row7 col13">0</td>
                        <td id="T_cef29_row7_col14" class="data row7 col14">0</td>
                        <td id="T_cef29_row7_col15" class="data row7 col15">0</td>
                        <td id="T_cef29_row7_col16" class="data row7 col16">0</td>
                        <td id="T_cef29_row7_col17" class="data row7 col17">0</td>
            </tr>
            <tr>
                        <th id="T_cef29_level0_row8" class="row_heading level0 row8">8</th>
                        <td id="T_cef29_row8_col0" class="data row8 col0">0</td>
                        <td id="T_cef29_row8_col1" class="data row8 col1">0</td>
                        <td id="T_cef29_row8_col2" class="data row8 col2">0</td>
                        <td id="T_cef29_row8_col3" class="data row8 col3">0</td>
                        <td id="T_cef29_row8_col4" class="data row8 col4">0</td>
                        <td id="T_cef29_row8_col5" class="data row8 col5">11</td>
                        <td id="T_cef29_row8_col6" class="data row8 col6">166</td>
                        <td id="T_cef29_row8_col7" class="data row8 col7">239</td>
                        <td id="T_cef29_row8_col8" class="data row8 col8">253</td>
                        <td id="T_cef29_row8_col9" class="data row8 col9">253</td>
                        <td id="T_cef29_row8_col10" class="data row8 col10">253</td>
                        <td id="T_cef29_row8_col11" class="data row8 col11">187</td>
                        <td id="T_cef29_row8_col12" class="data row8 col12">30</td>
                        <td id="T_cef29_row8_col13" class="data row8 col13">0</td>
                        <td id="T_cef29_row8_col14" class="data row8 col14">0</td>
                        <td id="T_cef29_row8_col15" class="data row8 col15">0</td>
                        <td id="T_cef29_row8_col16" class="data row8 col16">0</td>
                        <td id="T_cef29_row8_col17" class="data row8 col17">0</td>
            </tr>
            <tr>
                        <th id="T_cef29_level0_row9" class="row_heading level0 row9">9</th>
                        <td id="T_cef29_row9_col0" class="data row9 col0">0</td>
                        <td id="T_cef29_row9_col1" class="data row9 col1">0</td>
                        <td id="T_cef29_row9_col2" class="data row9 col2">0</td>
                        <td id="T_cef29_row9_col3" class="data row9 col3">0</td>
                        <td id="T_cef29_row9_col4" class="data row9 col4">0</td>
                        <td id="T_cef29_row9_col5" class="data row9 col5">16</td>
                        <td id="T_cef29_row9_col6" class="data row9 col6">248</td>
                        <td id="T_cef29_row9_col7" class="data row9 col7">250</td>
                        <td id="T_cef29_row9_col8" class="data row9 col8">253</td>
                        <td id="T_cef29_row9_col9" class="data row9 col9">253</td>
                        <td id="T_cef29_row9_col10" class="data row9 col10">253</td>
                        <td id="T_cef29_row9_col11" class="data row9 col11">253</td>
                        <td id="T_cef29_row9_col12" class="data row9 col12">232</td>
                        <td id="T_cef29_row9_col13" class="data row9 col13">213</td>
                        <td id="T_cef29_row9_col14" class="data row9 col14">111</td>
                        <td id="T_cef29_row9_col15" class="data row9 col15">2</td>
                        <td id="T_cef29_row9_col16" class="data row9 col16">0</td>
                        <td id="T_cef29_row9_col17" class="data row9 col17">0</td>
            </tr>
            <tr>
                        <th id="T_cef29_level0_row10" class="row_heading level0 row10">10</th>
                        <td id="T_cef29_row10_col0" class="data row10 col0">0</td>
                        <td id="T_cef29_row10_col1" class="data row10 col1">0</td>
                        <td id="T_cef29_row10_col2" class="data row10 col2">0</td>
                        <td id="T_cef29_row10_col3" class="data row10 col3">0</td>
                        <td id="T_cef29_row10_col4" class="data row10 col4">0</td>
                        <td id="T_cef29_row10_col5" class="data row10 col5">0</td>
                        <td id="T_cef29_row10_col6" class="data row10 col6">0</td>
                        <td id="T_cef29_row10_col7" class="data row10 col7">43</td>
                        <td id="T_cef29_row10_col8" class="data row10 col8">98</td>
                        <td id="T_cef29_row10_col9" class="data row10 col9">98</td>
                        <td id="T_cef29_row10_col10" class="data row10 col10">208</td>
                        <td id="T_cef29_row10_col11" class="data row10 col11">253</td>
                        <td id="T_cef29_row10_col12" class="data row10 col12">253</td>
                        <td id="T_cef29_row10_col13" class="data row10 col13">253</td>
                        <td id="T_cef29_row10_col14" class="data row10 col14">253</td>
                        <td id="T_cef29_row10_col15" class="data row10 col15">187</td>
                        <td id="T_cef29_row10_col16" class="data row10 col16">22</td>
                        <td id="T_cef29_row10_col17" class="data row10 col17">0</td>
            </tr>
    </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="BASELINE:-Pixel-similarity">
<a class="anchor" href="#BASELINE:-Pixel-similarity" aria-hidden="true"><span class="octicon octicon-link"></span></a>BASELINE: Pixel similarity<a class="anchor-link" href="#BASELINE:-Pixel-similarity"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seven_tensors</span> <span class="o">=</span> <span class="p">[</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">sevens</span><span class="p">]</span>
<span class="n">three_tensors</span> <span class="o">=</span> <span class="p">[</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">threes</span><span class="p">]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">three_tensors</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">seven_tensors</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(6131, 6265)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>’sevens’ are still list of paths. ’o’ is a path in the list, then with the list comprehension we use the path to read the image, then cast the image into tensor.(Same for threes). ’seven_tensor’ is a list of tensors
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_image</span><span class="p">(</span><span class="n">three_tensors</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-success">
    <svg class="octicon octicon-checklist octicon octicon-checklist octicon octicon-checklist octicon octicon-checklist" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M2.5 1.75a.25.25 0 01.25-.25h8.5a.25.25 0 01.25.25v7.736a.75.75 0 101.5 0V1.75A1.75 1.75 0 0011.25 0h-8.5A1.75 1.75 0 001 1.75v11.5c0 .966.784 1.75 1.75 1.75h3.17a.75.75 0 000-1.5H2.75a.25.25 0 01-.25-.25V1.75zM4.75 4a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-4.5zM4 7.75A.75.75 0 014.75 7h2a.75.75 0 010 1.5h-2A.75.75 0 014 7.75zm11.774 3.537a.75.75 0 00-1.048-1.074L10.7 14.145 9.281 12.72a.75.75 0 00-1.062 1.058l1.943 1.95a.75.75 0 001.055.008l4.557-4.45z"></path></svg>
    <strong>Tip: </strong>Show image shows the first tensor as image
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_image</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="n">im3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>check this  in more straight way (im3&gt;tensor&gt;image) 
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training-Set:--Stacking-Tensors">
<a class="anchor" href="#Training-Set:--Stacking-Tensors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Training Set:  Stacking Tensors<a class="anchor-link" href="#Training-Set:--Stacking-Tensors"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stacked_sevens</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">seven_tensors</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_threes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">three_tensors</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_threes</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([6131, 28, 28])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">stacked_sevens</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Tensor</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">stacked_sevens</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Tensor</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">seven_tensors</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>list</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>now we turn our list into a tensor size of ([6131, 28, 28])
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">stacked_threes</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>3</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>This is rank (lenght of the shape)
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stacked_threes</span><span class="o">.</span><span class="n">ndim</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>3</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>This is more direct way to get it. (ndim)
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Mean-of-threes-and-sevens-our-ideal-3-and-7.">
<a class="anchor" href="#Mean-of-threes-and-sevens-our-ideal-3-and-7." aria-hidden="true"><span class="octicon octicon-link"></span></a>Mean of threes and sevens our ideal 3 and 7.<a class="anchor-link" href="#Mean-of-threes-and-sevens-our-ideal-3-and-7."> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mean3</span> <span class="o">=</span> <span class="n">stacked_threes</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">mean3</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>This is the mean of the all tensors through first axis. ’Ideal Three’
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mean7</span> <span class="o">=</span> <span class="n">stacked_sevens</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">mean7</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a_3</span> <span class="o">=</span> <span class="n">stacked_threes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">a_3</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Distance-between-the-ideal-three-and-other-threes">
<a class="anchor" href="#Distance-between-the-ideal-three-and-other-threes" aria-hidden="true"><span class="octicon octicon-link"></span></a>Distance between the ideal three and other threes<a class="anchor-link" href="#Distance-between-the-ideal-three-and-other-threes"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dist_3_abs</span> <span class="o">=</span> <span class="p">(</span><span class="n">a_3</span> <span class="o">-</span> <span class="n">mean3</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">dist_3_sqr</span> <span class="o">=</span> <span class="p">((</span><span class="n">a_3</span> <span class="o">-</span> <span class="n">mean3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="n">dist_3_abs</span><span class="p">,</span><span class="n">dist_3_sqr</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(0.1114), tensor(0.2021))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dist_7_abs</span> <span class="o">=</span> <span class="p">(</span><span class="n">a_3</span> <span class="o">-</span> <span class="n">mean7</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">dist_7_sqr</span> <span class="o">=</span> <span class="p">((</span><span class="n">a_3</span> <span class="o">-</span> <span class="n">mean7</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="n">dist_7_abs</span><span class="p">,</span><span class="n">dist_7_sqr</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(0.1586), tensor(0.3021))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>Then we need to calculate the distance between the ’ideal’ and ordinary three.Two methods for getting the distance <strong>L1 Norm</strong> and <strong>MSE</strong> second one is panelize bigger mistake more havil, L1 is uniform.
</div>
It is obvious that a_3 is closer to the perfect 3 so our approach worked at this time. (Both in L1 and MSE)

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Pytorch-L1-and-MSE-fuctions">
<a class="anchor" href="#Pytorch-L1-and-MSE-fuctions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pytorch L1 and MSE fuctions<a class="anchor-link" href="#Pytorch-L1-and-MSE-fuctions"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">F</span><span class="o">.</span><span class="n">l1_loss</span><span class="p">(</span><span class="n">a_3</span><span class="o">.</span><span class="n">float</span><span class="p">(),</span><span class="n">mean7</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">mse_loss</span><span class="p">(</span><span class="n">a_3</span><span class="p">,</span><span class="n">mean7</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(0.1586), tensor(0.3021))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>torch.nn.functional as F (for mse, manually take the sqrt)
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-warn">
    <svg class="octicon octicon-zap octicon octicon-zap" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10.561 1.5a.016.016 0 00-.01.004L3.286 8.571A.25.25 0 003.462 9H6.75a.75.75 0 01.694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0012.538 7H9.25a.75.75 0 01-.683-1.06l2.008-4.418.003-.006a.02.02 0 00-.004-.009.02.02 0 00-.006-.006L10.56 1.5zM9.504.43a1.516 1.516 0 012.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 01-.871.354h-.302a1.25 1.25 0 01-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004L9.503.429z"></path></svg>
    <strong>Important: </strong>(from notebook) If you don’t know what C is, don’t worry as you won’t need it at all. In a nutshell, it’s a low-level (low-level means more similar to the language that computers use internally) language that is very fast compared to Python. To take advantage of its speed while programming in Python, try to avoid as much as possible writing loops, and replace them by commands that work directly on arrays or tensors.
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Array-and-Tensor-Examples">
<a class="anchor" href="#Array-and-Tensor-Examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Array and Tensor Examples<a class="anchor-link" href="#Array-and-Tensor-Examples"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">array</span> <span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">tns</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">arr</span>  <span class="c1"># numpy</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[1, 2, 3],
       [4, 5, 6]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tns</span>  <span class="c1"># pytorch</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[1, 2, 3],
        [4, 5, 6]])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Splitting,-adding,-multiplying-tensors">
<a class="anchor" href="#Splitting,-adding,-multiplying-tensors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Splitting, adding, multiplying tensors<a class="anchor-link" href="#Splitting,-adding,-multiplying-tensors"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tns</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([2, 5])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tns</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([5, 6])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tns</span><span class="o">+</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[2, 3, 4],
        [5, 6, 7]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tns</span><span class="o">.</span><span class="n">type</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>'torch.LongTensor'</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tns</span><span class="o">*</span><span class="mf">1.5</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[1.5000, 3.0000, 4.5000],
        [6.0000, 7.5000, 9.0000]])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Validation-set-:Stacking-Tensors">
<a class="anchor" href="#Validation-set-:Stacking-Tensors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Validation set :Stacking Tensors<a class="anchor-link" href="#Validation-set-:Stacking-Tensors"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">valid_3_tens</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> 
                            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'valid'</span><span class="o">/</span><span class="s1">'3'</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()])</span>
<span class="n">valid_3_tens</span> <span class="o">=</span> <span class="n">valid_3_tens</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_7_tens</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> 
                            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'valid'</span><span class="o">/</span><span class="s1">'7'</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()])</span>
<span class="n">valid_7_tens</span> <span class="o">=</span> <span class="n">valid_7_tens</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_3_tens</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">valid_7_tens</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([1010, 28, 28]), torch.Size([1028, 28, 28]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Manual-L1-distance-function">
<a class="anchor" href="#Manual-L1-distance-function" aria-hidden="true"><span class="octicon octicon-link"></span></a>Manual L1 distance function<a class="anchor-link" href="#Manual-L1-distance-function"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mnist_distance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="n">mnist_distance</span><span class="p">(</span><span class="n">a_3</span><span class="p">,</span> <span class="n">mean3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.1114)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="This-is-broadcasting:">
<a class="anchor" href="#This-is-broadcasting:" aria-hidden="true"><span class="octicon octicon-link"></span></a>This is broadcasting:<a class="anchor-link" href="#This-is-broadcasting:"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">valid_3_dist</span> <span class="o">=</span> <span class="n">mnist_distance</span><span class="p">(</span><span class="n">valid_3_tens</span><span class="p">,</span> <span class="n">mean3</span><span class="p">)</span>
<span class="n">valid_3_dist</span><span class="p">,</span> <span class="n">valid_3_dist</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor([0.1270, 0.1254, 0.1114,  ..., 0.1494, 0.1097, 0.1365]),
 torch.Size([1010]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>I think this an example of not using loops which slows down the process (check above important tag). Although shapes of the tensors don’t match, out function still works. Pytorch fills the gaps.
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>here is another example. Shapes don't match.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="n">tensor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([2, 3, 4])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">valid_3_tens</span><span class="o">-</span><span class="n">mean3</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([1010, 28, 28])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">is_3</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">mnist_distance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mean3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">mnist_distance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mean7</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_3</span><span class="p">(</span><span class="n">a_3</span><span class="p">),</span> <span class="n">is_3</span><span class="p">(</span><span class="n">a_3</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(True), tensor(1.))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="here-is-an-another-broadcasting-for-all-validation-set:">
<a class="anchor" href="#here-is-an-another-broadcasting-for-all-validation-set:" aria-hidden="true"><span class="octicon octicon-link"></span></a>here is an another broadcasting for all validation set:<a class="anchor-link" href="#here-is-an-another-broadcasting-for-all-validation-set:"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_3</span><span class="p">(</span><span class="n">valid_3_tens</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([True, True, True,  ..., True, True, True])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Accuracy-of-our-'ideal'-3-and-7">
<a class="anchor" href="#Accuracy-of-our-'ideal'-3-and-7" aria-hidden="true"><span class="octicon octicon-link"></span></a>Accuracy of our 'ideal' 3 and 7<a class="anchor-link" href="#Accuracy-of-our-'ideal'-3-and-7"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">accuracy_3s</span> <span class="o">=</span>      <span class="n">is_3</span><span class="p">(</span><span class="n">valid_3_tens</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span> <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">accuracy_7s</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">is_3</span><span class="p">(</span><span class="n">valid_7_tens</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">())</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">accuracy_3s</span><span class="p">,</span><span class="n">accuracy_7s</span><span class="p">,(</span><span class="n">accuracy_3s</span><span class="o">+</span><span class="n">accuracy_7s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(0.9168), tensor(0.9854), tensor(0.9511))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="STOCHASTIC-GRADIENT-DECENT-(SGD)">
<a class="anchor" href="#STOCHASTIC-GRADIENT-DECENT-(SGD)" aria-hidden="true"><span class="octicon octicon-link"></span></a>STOCHASTIC GRADIENT DECENT (SGD)<a class="anchor-link" href="#STOCHASTIC-GRADIENT-DECENT-(SGD)"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Arthur Samues Machine Learning process:</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Initialize the weights.</li>
<li>For each image, use these weights to predict whether it appears to be a 3 or a 7.</li>
<li>Based on these predictions, calculate how good the model is (its loss).</li>
<li>Calculate the gradient, which measures for each weight, how changing that weight would change the loss (SGD)</li>
<li>Step (that is, change) all the weights based on that calculation.</li>
<li>Go back to the step 2, and repeat the process.</li>
<li>Iterate until you decide to stop the training process (for instance, because the model is good enough or you don't want to wait any longer).</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#caption The gradient descent process</span>
<span class="c1">#alt Graph showing the steps for Gradient Descent</span>
<span class="n">gv</span><span class="p">(</span><span class="s1">'''</span>
<span class="s1">init-&gt;predict-&gt;loss-&gt;gradient-&gt;step-&gt;stop</span>
<span class="s1">step-&gt;predict[label=repeat]</span>
<span class="s1">'''</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: G Pages: 1 -->
<svg width="661pt" height="73pt" viewbox="0.00 0.00 660.87 73.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 69)">
<title>G</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-69 656.867,-69 656.867,4 -4,4"></polygon>
<!-- init -->
<g id="node1" class="node"><title>init</title>
<ellipse fill="none" stroke="black" cx="27" cy="-18" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="27" y="-14.3" font-family="Times,serif" font-size="14.00">init</text>
</g>
<!-- predict -->
<g id="node2" class="node"><title>predict</title>
<ellipse fill="none" stroke="black" cx="135.196" cy="-18" rx="44.393" ry="18"></ellipse>
<text text-anchor="middle" x="135.196" y="-14.3" font-family="Times,serif" font-size="14.00">predict</text>
</g>
<!-- init&#45;&gt;predict -->
<g id="edge1" class="edge"><title>init-&gt;predict</title>
<path fill="none" stroke="black" d="M54.2507,-18C62.3698,-18 71.6255,-18 80.8895,-18"></path>
<polygon fill="black" stroke="black" points="80.892,-21.5001 90.892,-18 80.892,-14.5001 80.892,-21.5001"></polygon>
</g>
<!-- loss -->
<g id="node3" class="node"><title>loss</title>
<ellipse fill="none" stroke="black" cx="244.99" cy="-47" rx="28.6953" ry="18"></ellipse>
<text text-anchor="middle" x="244.99" y="-43.3" font-family="Times,serif" font-size="14.00">loss</text>
</g>
<!-- predict&#45;&gt;loss -->
<g id="edge2" class="edge"><title>predict-&gt;loss</title>
<path fill="none" stroke="black" d="M172.39,-27.7373C184.027,-30.868 196.903,-34.332 208.489,-37.4493"></path>
<polygon fill="black" stroke="black" points="207.71,-40.8641 218.276,-40.0823 209.529,-34.1044 207.71,-40.8641"></polygon>
</g>
<!-- gradient -->
<g id="node4" class="node"><title>gradient</title>
<ellipse fill="none" stroke="black" cx="406.633" cy="-47" rx="50.0912" ry="18"></ellipse>
<text text-anchor="middle" x="406.633" y="-43.3" font-family="Times,serif" font-size="14.00">gradient</text>
</g>
<!-- loss&#45;&gt;gradient -->
<g id="edge3" class="edge"><title>loss-&gt;gradient</title>
<path fill="none" stroke="black" d="M273.797,-47C293.819,-47 321.573,-47 346.455,-47"></path>
<polygon fill="black" stroke="black" points="346.548,-50.5001 356.548,-47 346.547,-43.5001 346.548,-50.5001"></polygon>
</g>
<!-- step -->
<g id="node5" class="node"><title>step</title>
<ellipse fill="none" stroke="black" cx="524.225" cy="-18" rx="30.5947" ry="18"></ellipse>
<text text-anchor="middle" x="524.225" y="-14.3" font-family="Times,serif" font-size="14.00">step</text>
</g>
<!-- gradient&#45;&gt;step -->
<g id="edge4" class="edge"><title>gradient-&gt;step</title>
<path fill="none" stroke="black" d="M448.061,-36.8572C460.37,-33.7692 473.838,-30.3904 485.93,-27.3568"></path>
<polygon fill="black" stroke="black" points="486.86,-30.7319 495.708,-24.9036 485.157,-23.9423 486.86,-30.7319"></polygon>
</g>
<!-- step&#45;&gt;predict -->
<g id="edge6" class="edge"><title>step-&gt;predict</title>
<path fill="none" stroke="black" d="M493.675,-18C428.652,-18 272.394,-18 189.665,-18"></path>
<polygon fill="black" stroke="black" points="189.467,-14.5001 179.467,-18 189.467,-21.5001 189.467,-14.5001"></polygon>
<text text-anchor="middle" x="315.087" y="-21.8" font-family="Times,serif" font-size="14.00">repeat</text>
</g>
<!-- stop -->
<g id="node6" class="node"><title>stop</title>
<ellipse fill="none" stroke="black" cx="622.32" cy="-18" rx="30.5947" ry="18"></ellipse>
<text text-anchor="middle" x="622.32" y="-14.3" font-family="Times,serif" font-size="14.00">stop</text>
</g>
<!-- step&#45;&gt;stop -->
<g id="edge5" class="edge"><title>step-&gt;stop</title>
<path fill="none" stroke="black" d="M554.841,-18C563.244,-18 572.533,-18 581.437,-18"></path>
<polygon fill="black" stroke="black" points="581.637,-21.5001 591.637,-18 581.637,-14.5001 581.637,-21.5001"></polygon>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="GD-example">
<a class="anchor" href="#GD-example" aria-hidden="true"><span class="octicon octicon-link"></span></a>GD example<a class="anchor-link" href="#GD-example"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_function</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">'x'</span><span class="p">,</span> <span class="s1">'x**2'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We need to decrease the loss</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><figure>
  
    <img class="docimage" src="/images/copied_from_nb/images/chapter-04/grad_illustration.svg" alt="A graph showing the squared function with the slope at one point" style="max-width: 400px">
    
    
</figure>
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="How-to-calculate-gradient:">
<a class="anchor" href="#How-to-calculate-gradient:" aria-hidden="true"><span class="octicon octicon-link"></span></a>How to calculate gradient:<a class="anchor-link" href="#How-to-calculate-gradient:"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Now our tensor xt is under investigation. Pytorch will keeps its eye on it.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xt</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="mf">3.</span><span class="p">)</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">yt</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xt</span><span class="p">)</span>
<span class="n">yt</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(9., grad_fn=&lt;PowBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Result is 9 but there is a grad function in the result.</strong></p>
<hr>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">yt</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>backward calculates the derivative.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xt</span><span class="o">.</span><span class="n">grad</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(6.)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>result is 6.</strong></p>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>now with a bigger tensor</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xt</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">3.</span><span class="p">,</span><span class="mf">4.</span><span class="p">,</span><span class="mf">10.</span><span class="p">])</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">()</span>
<span class="n">xt</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([ 3.,  4., 10.], requires_grad=True)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">yt</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xt</span><span class="p">)</span>
<span class="n">yt</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(125., grad_fn=&lt;SumBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>again we expect 2*xt:</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">yt</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xt</span><span class="o">.</span><span class="n">grad</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([ 6.,  8., 20.])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="End-to-end-SGD-example">
<a class="anchor" href="#End-to-end-SGD-example" aria-hidden="true"><span class="octicon octicon-link"></span></a>End to end SGD example<a class="anchor-link" href="#End-to-end-SGD-example"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
<span class="n">time</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12., 13., 14., 15., 16., 17., 18., 19.])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">speed</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="mf">0.75</span><span class="o">*</span><span class="p">(</span><span class="n">time</span><span class="o">-</span><span class="mf">9.5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">speed</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.PathCollection at 0x7f8f2edd27c0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXMAAAD7CAYAAACYLnSTAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8rg+JYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAXl0lEQVR4nO3df4zcdZ3H8efLtpEN7bpCV7xuQisorVew9lyjkYDmwGs0MfZak0M4RHOk/ggX71ejvbNQQVO0epec+KsJKireIbrsiZw2xwGneEpcrKXZ2PauYJWtP7bqlm67hdJ73x/zHZiOszPf6Xy/M7PfeT2SCZ3P9zMzbz47+9rvfL6f+X4VEZiZ2dz2nE4XYGZmrXOYm5kVgMPczKwAHOZmZgXgMDczK4D5nXjRxYsXx7Jlyzrx0mZmc9bDDz98KCIGa23rSJgvW7aMsbGxTry0mdmcJenAbNs8zWJmVgAOczOzAnCYm5kVgMPczKwAGoa5pOmq20lJn6jYfpmkPZKOSbpf0tJ8SzYzs2oNV7NExMLyvyUtBH4J3JncXwyMANcCdwM3AXcAr86j2NGdE2zbsZeDUzMsGehj45rlrF09lMdLmZnNKc0uTVwP/Br4bnJ/HTAeEeVw3wIckrQiIvZkViWlIN80spuZEycBmJiaYdPIbgAHupn1vGbnzK8BvhjPnjd3JbCrvDEijgL7k/ZTSNogaUzS2OTkZNOFbtux95kgL5s5cZJtO/Y2/VxmZkWTOsyTufDXArdVNC8EDld1PQwsqn58RGyPiOGIGB4crPkFproOTs001W5m1kua2TO/GngwIh6raJsG+qv69QNHWi2s2pKBvqbazcx6STNh/jZO3SsHGAdWle9IOhM4P2nP1MY1y+lbMO+Utr4F89i4ZnnWL2VmNuekOgAq6TXAEMkqlgp3AdskrQfuAa4HHsn64Cc8e5DTq1nMbC7KezVe2tUs1wAjEXHK9ElETCZBfgvwZeAh4IrMqquydvWQw9vM5px2rMZLFeYR8c462+4FVmRSjZlZAdVbjZdVmPvr/GZmOWvHajyHuZlZztqxGs9hbmaWs3asxuvIlYbMzHpJO1bjOczNzNog79V4nmYxMysAh7mZWQE4zM3MCsBhbmZWAA5zM7MCcJibmRWAw9zMrAAc5mZmBeAwNzMrAIe5mVkBOMzNzArAYW5mVgCpw1zSFZJ+IumopP2SLknaL5O0R9IxSfdLWppfuWZmVkuqMJf0euAjwDuARcClwKOSFgMjwGbgLGAMuCOfUs3MbDZpT4H7QeDGiPhBcn8CQNIGYDwi7kzubwEOSVoREXuyLtbMzGpruGcuaR4wDAxK+l9Jj0u6RVIfsBLYVe4bEUeB/Ul79fNskDQmaWxycjK7/wMzM0s1zXIOsAB4C3AJ8HJgNfABYCFwuKr/YUpTMaeIiO0RMRwRw4ODg63UbGZmVdKEefny0Z+IiF9ExCHgH4E3AtNAf1X/fuBIdiWamVkjDcM8In4HPA5EZXPy33FgVblR0pnA+Um7mZm1SdqliZ8H/lLSCyQ9H/hr4JvAXcCFktZLOgO4HnjEBz/NrGhGd05w8c338aL338PFN9/H6M6JTpd0irSrWW4CFgP7gOPAV4EPR8RxSeuBW4AvAw8BV+RRqJlZp4zunGDTyG5mTpwEYGJqhk0juwFyvUhzM1KFeUScAN6T3Kq33QusyLguM7OusW3H3meCvGzmxEm27djbNWHur/ObmTVwcGqmqfZOSDvNUgijOyfYtmMvB6dmWDLQx8Y1y7vmr6qZda8lA31M1AjuJQN9Haimtp7ZMy/PeU1MzRA8O+fVbQcxzKz7bFyznL4F805p61swj41rlneoot/XM2Feb87LzKyetauH2LruIoYG+hAwNNDH1nUXddUn+56ZZpkLc15m1r3Wrh7qqvCu1jN75rPNbXXTnJeZ2enqmTCfC3NeZmanq2emWcofj7yaxcyKqGfCHLp/zsvM7HT1zDSLmVmROczNzArAYW5mVgAOczOzAnCYm5kVgMPczKwAHOZmZgXgMDczK4BUYS7pAUnHJU0nt70V266UdEDSUUmjks7Kr1wzM6ulmT3z6yJiYXJbDiBpJfBZ4GrgHOAY8KnsyzQzs3pa/Tr/VcDdEfEdAEmbgZ9IWhQRR1quzszMUmlmz3yrpEOSvifpdUnbSmBXuUNE7AeeAi6ofrCkDZLGJI1NTk62ULKZmVVLG+bvA84DhoDtwN2SzgcWAoer+h4GFlU/QURsj4jhiBgeHBxsoWQzM6uWKswj4qGIOBIRT0bEbcD3gDcC00B/Vfd+wFMsZmZtdLpLEwMQMA6sKjdKOg94LrCv9dLMzCythgdAJQ0ArwL+C3ga+DPgUuC9wALg+5IuAX4E3AiM+OCnmVl7pVnNsgD4ELACOAnsAdZGxD4ASe8CbgfOBu4F3pFPqWZmNpuGYR4Rk8Ar62z/CvCVLIsyM7Pm+Ov8ZmYF4DA3MysAh7mZWQE4zM3MCsBhbmZWAA5zM7MCcJibmRWAw9zMrAAc5mZmBeAwNzMrAIe5mVkBOMzNzAqg1WuAmpnNCaM7J9i2Yy8Hp2ZYMtDHxjXLWbt6qNNlZcZh3oSivxnMimp05wSbRnYzc+IkABNTM2wa2Q1QmN9hT7OkVH4zTEzNEDz7ZhjdOdHp0sysgW079j4T5GUzJ06ybcfeDlWUPYd5Sr3wZjArqoNTM021z0UO85R64c1gVlRLBvqaap+LmgpzSS+RdFzSlyvarpR0QNJRSaOSzsq+zM7rhTeDWVFtXLOcvgXzTmnrWzCPjWuWd6ii7DW7Z/5J4IflO5JWAp8FrgbOAY4Bn8qsui7SC28Gs6Jau3qIresuYmigDwFDA31sXXdRYQ5+QhOrWSRdAUwB/w28OGm+Crg7Ir6T9NkM/ETSoog4knGtHVX+oXs1i9nctHb1UKF/X1OFuaR+4Ebgj4FrKzatpBTuAETEfklPARcAD2dYZ1co+pvBzOautNMsNwG3RsTjVe0LgcNVbYeBRdVPIGmDpDFJY5OTk81XamZms2oY5pJeDlwO/FONzdNAf1VbP/B7UywRsT0ihiNieHBw8DRKNTOz2aSZZnkdsAz4mSQo7Y3Pk/SHwLeBVeWOks4Dngvsy7pQMzObXZow3w78a8X9v6MU7u8GXgB8X9IlwI8ozauPFO3gp5lZt2sY5hFxjNKSQwAkTQPHI2ISmJT0LuB24GzgXuAdOdVqZmazaPpEWxGxper+V4CvZFWQmZk1z1/nNzMrAIe5mVkBOMzNzArAYW5mVgAOczOzAnCYm5kVgMPczKwAHOZmZgXgMDczKwCHuZlZATjMzcwKwGFuZlYATZ9oy07f6M4JX0PUzHLhMG+T0Z0TbBrZzcyJkwBMTM2waWQ3gAPdzFrmaZY22bZj7zNBXjZz4iTbduztUEVmViQO8zY5ODXTVLuZWTM8zdImSwb6mKgR3EsG+jpQjdnc42NO9XnPvE02rllO34J5p7T1LZjHxjXLO1SR2dxRPuY0MTVD8Owxp9GdE50urWukCnNJX5b0C0lPSNon6dqKbZdJ2iPpmKT7JS3Nr9y5a+3qIbauu4ihgT4EDA30sXXdRd6zMEvBx5waSzvNshX4i4h4UtIK4AFJO4EDwAhwLXA3cBNwB/DqPIqd69auHnJ4m50GH3NqLNWeeUSMR8ST5bvJ7XxgHTAeEXdGxHFgC7AqCXwzs0zMdmzJx5yelXrOXNKnJB0D9gC/AP4dWAnsKveJiKPA/qS9+vEbJI1JGpucnGy5cDPrHT7m1FjqMI+I9wCLgEsoTa08CSwEDld1PZz0q3789ogYjojhwcHB06/YzHqOjzk11tTSxIg4CTwo6c+BdwPTQH9Vt37gSDblmZmV+JhTfae7NHE+pTnzcWBVuVHSmRXtZmbWJg3DXNILJF0haaGkeZLWAG8F/hO4C7hQ0npJZwDXA49ExJ58yzYzs0pp9syD0pTK48DvgI8BfxUR34iISWA98OFk26uAK3Kq1czMZtFwzjwJ7NfW2X4v4KWIZmYd5HOzmFlb+Nwq+XKYm1nufD7//PlEW2aWO59bJX8OczPLnc+tkj+HuZnlzudWyZ/D3Mxy53Or5M8HQM0sd+WDnF7Nkh+HuZm1hc+tki9Ps5iZFYDD3MysABzmZmYF4DA3MysAh7mZWQE4zM3MCsBhbmZWAA5zM7MCcJibmRVAmmuAPlfSrZIOSDoi6ceS3lCx/TJJeyQdk3S/pKX5lmxmZtXS7JnPB35O6dJxzwM+AHxV0jJJi4ERYDNwFjAG3JFTrWZmNos01wA9CmypaPqmpMeAVwBnA+MRcSeApC3AIUkrImJP9uWamVktTZ9oS9I5wAXAOPBuYFd5W0QclbQfWAnsqXrcBmADwLnnnttCyb3L11A0s9k0dQBU0gLgduC2ZM97IXC4qtthYFH1YyNie0QMR8Tw4ODg6dbbs8rXUJyYmiF49hqKozsnOl2amXWB1Hvmkp4DfAl4CrguaZ4G+qu69gNHMqnOnlHvGoreO7d28CfD7pZqz1ySgFuBc4D1EXEi2TQOrKrodyZwftJuGfI1FK2T/Mmw+6WdZvk08FLgTRFRmR53ARdKWi/pDOB64BEf/Myer6FonVTvk6F1hzTrzJcC7wReDvxS0nRyuyoiJoH1wIeB3wGvAq7Isd6e5WsoWif5k2H3S7M08QCgOtvvBVZkWZT9Pl9D0TppyUAfEzWC258Mu4evATqH+BqK1ikb1yxn08juU6Za/MmwuzjMzawhfzLsfg5zM0vFnwy7m8+aaGZWAA5zM7MCcJibmRWAw9zMrAAc5mZmBeAwNzMrAIe5mVkBOMzNzArAYW5mVgAOczOzAnCYm5kVgM/N0kN82a/e5p9/sTnMe0T5sl/lU5iWL/sF+Be6B/jnX3yeZukRvuxXb/PPv/jSXtD5Okljkp6U9IWqbZdJ2iPpmKT7k8vMWZfxZb96m3/+xZd2z/wg8CHgc5WNkhYDI8Bm4CxgDLgjywItG1lcEHp05wQX33wfL3r/PVx8832+Mvsc4guCF1+qMI+IkYgYBX5TtWkdMB4Rd0bEcWALsEqSrwnaZVq9IHR5znViaobg2TlXB3p6nfxj6AuCF1+rc+YrgV3lOxFxFNiftFsXWbt6iK3rLmJooA8BQwN9bF13UeqDX55zbU2n/xi2+vO37tfqapaFwGRV22FgUXVHSRuADQDnnntuiy9rp6OVy355zrU19f4YtitQfdm3Ymt1z3wa6K9q6weOVHeMiO0RMRwRw4ODgy2+rLWb51xb4z+GlrdWw3wcWFW+I+lM4Pyk3QrEc66t8R9Dy1vapYnzJZ0BzAPmSTpD0nzgLuBCSeuT7dcDj0TEnvxKtk7wnGtr/MfQ8qaIaNxJ2gLcUNX8wYjYIuly4BZgKfAQ8PaI+Gm95xseHo6xsbHTKthsrmr16/T+Or5JejgihmtuSxPmWXOY2+no5TCr/jo+lPbs/emot9QLc3+d3+aETi/t6zQvDbVGHOY2J/R6mHk1jDXiMLc5odfDzKthrBGHuc0JvR5mXg1jjTjMbU7o9TDz0lBrxBensDmhHFq9upoF/HV8q89hbm3T6tJCh5nZ7Bzm1ha+bJlZvjxnbm3R60sLzfLmMLe26PWlhWZ5c5hbW/T60kKzvDnMrS16fWmhWd58ANTawksLzfLlMLe28dJCs/x4msXMrAAc5mZmBeAwNzMrAIe5mVkBZBLmks6SdJeko5IOSLoyi+c1y9Lozgkuvvk+XvT+e7j45vt65ipF1huyWs3ySeAp4Bzg5cA9knZFxHhGz2/WEp8bxoqu5T1zSWcC64HNETEdEQ8C3wCubvW5zbLic8NY0WUxzXIB8HRE7Kto2wWsrOwkaYOkMUljk5OTGbysWXo+N4wVXRZhvhB4oqrtMLCosiEitkfEcEQMDw4OZvCyZun53DBWdFmE+TTQX9XWDxzJ4LnNMuFzw1jRZXEAdB8wX9JLIuJ/krZVgA9+WtfwuWGs6FoO84g4KmkEuFHStZRWs7wZeE2rz22WJZ8bxoosq6WJ7wE+B/wa+A3wbi9LtKJp9RqmZnnKJMwj4rfA2iyey6wbeZ26dTt/nd8sBa9Tt27nMDdLwevUrds5zM1S8Dp163YOc7MUvE7dup0vG2eWgtepW7dzmJul5HXq1s08zWJmVgAOczOzAnCYm5kVgMPczKwAHOZmZgWgiGj/i0qTwIEWnmIxcCijcvLg+lrj+lrj+lrTzfUtjYiaV/fpSJi3StJYRAx3uo7ZuL7WuL7WuL7WdHt9s/E0i5lZATjMzcwKYK6G+fZOF9CA62uN62uN62tNt9dX05ycMzczs1PN1T1zMzOr4DA3MysAh7mZWQF0ZZhLOkvSXZKOSjog6cpZ+knSRyT9Jrl9RJJyru25km5N6joi6ceS3jBL37dLOilpuuL2ujzrS173AUnHK16z5oUqOzR+01W3k5I+MUvftoyfpOskjUl6UtIXqrZdJmmPpGOS7pe0tM7zLEv6HEsec3me9Ul6taT/kPRbSZOS7pT0B3WeJ9X7IsP6lkmKqp/f5jrP0+7xu6qqtmNJva+Y5XlyGb+sdGWYA58EngLOAa4CPi1pZY1+G4C1wCrgZcCbgHfmXNt84OfAa4HnAR8Avipp2Sz9vx8RCytuD+RcX9l1Fa852+Vw2j5+lWMBvBCYAe6s85B2jN9B4EPA5yobJS0GRoDNwFnAGHBHnef5F2AncDbwD8DXJNX8tl4W9QHPp7TyYhmwFDgCfL7Bc6V5X2RVX9lAxWveVOd52jp+EXF71fvxPcCjwI/qPFce45eJrgtzSWcC64HNETEdEQ8C3wCurtH9GuDjEfF4REwAHwfenmd9EXE0IrZExE8j4v8i4pvAY0DNv+Zdru3jV2U98Gvgu218zd8TESMRMQr8pmrTOmA8Iu6MiOPAFmCVpBXVzyHpAuCPgBsiYiYivg7spvT/mEt9EfGtpLYnIuIYcAtwcauvl1V9zejE+NVwDfDFmKNL/LouzIELgKcjYl9F2y6g1p75ymRbo365kXQOpZrHZ+myWtIhSfskbZbUrqs7bU1e93t1piY6PX5pfnk6NX5QNT4RcRTYz+zvxUcj4khFW7vH81Jmfx+WpXlfZO2ApMclfT75tFNLR8cvmT67FPhig66dGL9UujHMFwJPVLUdBhbN0vdwVb+Fec/7lklaANwO3BYRe2p0+Q5wIfACSnsYbwU2tqG09wHnAUOUPobfLen8Gv06Nn7JL89rgdvqdOvU+JVVjw+kfy/W65s5SS8Drqf++KR9X2TlEPBKSlNAr6A0FrfP0rej4we8DfhuRDxWp0+7x68p3Rjm00B/VVs/pfnARn37gel2fEyS9BzgS5Tm9q+r1SciHo2Ix5LpmN3AjcBb8q4tIh6KiCMR8WRE3AZ8D3hjja4dGz9K02YP1vvl6dT4VWjlvVivb6YkvRj4FvDeiJh1yqqJ90UmkmnSsYh4OiJ+Ren35E8k1Qrojo1f4m3U37Fo+/g1qxvDfB8wX9JLKtpWUfvj43iyrVG/TCV7rrdSOkC7PiJOpHxoAG351JDydTsyfomGvzw1tHv8Thmf5HjO+cz+XjyvKqhyH8/kE869wE0R8aUmH97u8SzvJNTKnY6MH4Cki4ElwNeafGinfp9r6rowT+YlR4AbJZ2ZDPSbKe0FV/si8DeShiQtAf4W+EIbyvw08FLgTRExM1snSW9I5tRJDpptBv4tz8IkDUhaI+kMSfMlXUVpLvDbNbp3ZPwkvYbSR9V6q1jaNn7JOJ0BzAPmlccOuAu4UNL6ZPv1wCO1ptSSYzw/Bm5IHv+nlFYIfT2v+iQNAfcBt0TEZxo8RzPvi6zqe5Wk5ZKeI+ls4J+BByKiejqlI+NX0eUa4OtV8/XVz5Hb+GUmIrruRmkZ2ChwFPgZcGXSfgmlaYByPwEfBX6b3D5Kcr6ZHGtbSukv8nFKHw3Lt6uAc5N/n5v0/Rjwq+T/41FK0wQLcq5vEPghpY+nU8APgNd3y/glr/tZ4Es12jsyfpRWqUTVbUuy7XJgD6UllA8Ayyoe9xngMxX3lyV9ZoC9wOV51gfckPy78n1Y+fP9e+Bbjd4XOdb3VkorvY4Cv6C08/DCbhm/ZNsZyXhcVuNxbRm/rG4+0ZaZWQF03TSLmZk1z2FuZlYADnMzswJwmJuZFYDD3MysABzmZmYF4DA3MysAh7mZWQH8P+vctCOu+6ZUAAAAAElFTkSuQmCC%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Now we are trying to come up with some parameters for our quadratic fuction that predicts speed any given time. Our choice is quadratic but that could be something else too. with a quadratic function our problem would be much easier.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>here is the function gets time and parameter as inputs and predicts a result:</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="n">params</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>this our loss function that calculate distance between prediction and target( actual mesurements)</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mse</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span> <span class="k">return</span> <span class="p">((</span><span class="n">preds</span><span class="o">-</span><span class="n">targets</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-1:-here-are-initial-random-parameters:">
<a class="anchor" href="#Step-1:-here-are-initial-random-parameters:" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Step 1: here are initial random parameters:</strong><a class="anchor-link" href="#Step-1:-here-are-initial-random-parameters:"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">()</span>
<span class="n">params</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([ 0.9569,  0.0048, -0.1506], requires_grad=True)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">orig_params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-2:-calculate-predictions:">
<a class="anchor" href="#Step-2:-calculate-predictions:" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 2: calculate predictions:<a class="anchor-link" href="#Step-2:-calculate-predictions:"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">params</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">show_preds</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">speed</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">to_np</span><span class="p">(</span><span class="n">preds</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_preds</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-3:-Calculate-the-loss">
<a class="anchor" href="#Step-3:-Calculate-the-loss" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 3: Calculate the loss<a class="anchor-link" href="#Step-3:-Calculate-the-loss"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss</span> <span class="o">=</span> <span class="n">mse</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">speed</span><span class="p">)</span>
<span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(139.3082, grad_fn=&lt;SqrtBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<p><strong>The Question is how to improve these results:</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-4:-first-we-calculate-the-gradient:">
<a class="anchor" href="#Step-4:-first-we-calculate-the-gradient:" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 4: first we calculate the gradient:<a class="anchor-link" href="#Step-4:-first-we-calculate-the-gradient:"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Pytorch makes it easier we just call the backward() on the loss but it calculates gradient for the params 'a' 'b' and 'c'._</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="n">params</span><span class="o">.</span><span class="n">grad</span> <span class="c1"># this is the derivative of the initial values in other word our slope.</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([165.0324,  10.5991,   0.6615])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">params</span><span class="o">.</span><span class="n">grad</span> <span class="o">*</span> <span class="mf">1e-5</span> <span class="c1"># scaler at the end is learning rate.</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([1.6503e-03, 1.0599e-04, 6.6150e-06])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">params</span> <span class="c1"># they are still same.</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([ 0.9569,  0.0048, -0.1506], requires_grad=True)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h4 id="Step-5:-Step-the-weight.">
<a class="anchor" href="#Step-5:-Step-the-weight." aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 5: Step the weight.<a class="anchor-link" href="#Step-5:-Step-the-weight."> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>we picked the learning rate 1e-5 very small step to avoid missing the lowest possible loss.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">params</span><span class="o">.</span><span class="n">data</span> <span class="o">-=</span> <span class="n">lr</span> <span class="o">*</span> <span class="n">params</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span>
<span class="n">params</span><span class="o">.</span><span class="n">grad</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">params</span><span class="p">)</span>
<span class="n">mse</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">speed</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(139.0348, grad_fn=&lt;SqrtBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>lets create a function for all these steps</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">apply_step</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">prn</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">mse</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">speed</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">params</span><span class="o">.</span><span class="n">data</span> <span class="o">-=</span> <span class="n">lr</span> <span class="o">*</span> <span class="n">params</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span>
    <span class="n">params</span><span class="o">.</span><span class="n">grad</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">prn</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">preds</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-6:-repeat-the-step:">
<a class="anchor" href="#Step-6:-repeat-the-step:" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 6: repeat the step:<a class="anchor-link" href="#Step-6:-repeat-the-step:"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="n">apply_step</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>139.03475952148438
138.76133728027344
138.4879150390625
138.2145538330078
137.94122314453125
137.6679229736328
137.39466857910156
137.12144470214844
136.84825134277344
136.5751190185547
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">orig_params</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span> <span class="n">show_preds</span><span class="p">(</span><span class="n">apply_step</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h2 id="MNIST">
<a class="anchor" href="#MNIST" aria-hidden="true"><span class="octicon octicon-link"></span></a>MNIST<a class="anchor-link" href="#MNIST"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Loss-Function-our-3-and-7-recognizer.-Currently-we-use-metric-not-loss">
<a class="anchor" href="#Loss-Function-our-3-and-7-recognizer.-Currently-we-use-metric-not-loss" aria-hidden="true"><span class="octicon octicon-link"></span></a>Loss Function our 3 and 7 recognizer. Currently we use metric not loss<a class="anchor-link" href="#Loss-Function-our-3-and-7-recognizer.-Currently-we-use-metric-not-loss"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">stacked_threes</span><span class="p">,</span> <span class="n">stacked_sevens</span><span class="p">])</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_x</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([12396, 784])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_y</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">threes</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">sevens</span><span class="p">))</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">train_x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">train_y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([12396, 784]), torch.Size([12396, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="How-tensor-manipulated">
<a class="anchor" href="#How-tensor-manipulated" aria-hidden="true"><span class="octicon octicon-link"></span></a>How tensor manipulated<a class="anchor-link" href="#How-tensor-manipulated"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">temp_tensor</span> <span class="o">=</span> <span class="n">tensor</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">temp_tensor</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(1)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">temp_tensor</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Tensor</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>is above tensor is wrong what's the difference?</strong></p>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>we have a tensor</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">temp_tensor</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>then we multiuplied the inside of</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">temp_tensor</span> <span class="o">=</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">temp_tensor</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([1, 1, 1, 1])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">temp_tensor</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([4])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">temp_tensor</span><span class="o">.</span><span class="n">ndim</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">temp_tensor</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([4])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">temp_tensor</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[1],
        [1],
        [1],
        [1]])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-error">
    <svg class="octicon octicon-alert octicon octicon-alert" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path></svg>
    <strong>Warning: </strong><strong>looked changed but why size is still unchanged why not [4,1]</strong>
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">temp_tensor</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([4])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">temp_tensor</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([4])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="How-unsqueeze-works?">
<a class="anchor" href="#How-unsqueeze-works?" aria-hidden="true"><span class="octicon octicon-link"></span></a>How unsqueeze works?<a class="anchor-link" href="#How-unsqueeze-works?"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-error">
    <svg class="octicon octicon-alert octicon octicon-alert octicon octicon-alert" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path></svg>
    <strong>Warning: </strong>Whaaaaaaaaaaaaat?
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(temp_tensor).unsqueeze(1) doesn't work but (temp_tensor*1).unsqueeze(1) you need to unsqueeze it when creating otherwise it doesnt work. I do not believe it.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">temp_tensor</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">temp_tensor</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([1, 1])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">temp_tensor</span> <span class="o">=</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Dataset">
<a class="anchor" href="#Dataset" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dataset<a class="anchor-link" href="#Dataset"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span><span class="n">train_y</span><span class="p">))</span>
<span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">dset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span><span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([784]), 1, tensor([1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>we create list of tuples, each tuple contains a image and a target</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">valid_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">valid_3_tens</span><span class="p">,</span> <span class="n">valid_7_tens</span><span class="p">])</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span>
<span class="n">valid_y</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_3_tens</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_7_tens</span><span class="p">))</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">valid_dset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">valid_x</span><span class="p">,</span><span class="n">valid_y</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>same for validation</strong></p>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Weights">
<a class="anchor" href="#Weights" aria-hidden="true"><span class="octicon octicon-link"></span></a>Weights<a class="anchor-link" href="#Weights"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>this is not clear on the videos but consider a layer NN of 728 inputs and 1 output.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">init_params</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="o">*</span><span class="n">std</span><span class="p">)</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="n">init_params</span><span class="p">((</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([784, 1])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bias</span> <span class="o">=</span> <span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>The function <code>weights*pixels</code> won’t be flexible enough—it is always equal to 0 when the pixels are equal to 0 (i.e., its <em>intercept</em> is 0). You might remember from high school math that the formula for a line is <code>y=w*x+b</code>; we still need the <code>b</code>. We’ll initialize it to a random number too:
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bias</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([0.0959], requires_grad=True)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Again transposing the weight matrix is not clear but Tariq Rashed's book would be very beneficial at this point</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">train_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">weights</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="n">bias</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([-5.6867], grad_fn=&lt;AddBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>for all dataset put this multiplication in a function</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">linear1</span><span class="p">(</span><span class="n">xb</span><span class="p">):</span> <span class="k">return</span> <span class="n">xb</span><span class="nd">@weights</span> <span class="o">+</span> <span class="n">bias</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">linear1</span><span class="p">(</span><span class="n">train_x</span><span class="p">)</span>
<span class="n">preds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ -5.6867],
        [ -6.5451],
        [ -2.0241],
        ...,
        [-14.3286],
        [  4.3505],
        [-12.6773]], grad_fn=&lt;AddBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Create a tensor with results based on their value (above 0.5 is 7 and below it is 3)</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">corrects</span> <span class="o">=</span> <span class="p">(</span><span class="n">preds</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span> <span class="o">==</span> <span class="n">train_y</span>
<span class="n">corrects</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[False],
        [False],
        [False],
        ...,
        [ True],
        [False],
        [ True]])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<p><strong>check it</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">corrects</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.4636172950267792</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>almost half of them is 3 and the other half is 7 (since weighs are totally random)</strong></p>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Why-we-need-a-loss-Function">
<a class="anchor" href="#Why-we-need-a-loss-Function" aria-hidden="true"><span class="octicon octicon-link"></span></a>Why we need a loss Function<a class="anchor-link" href="#Why-we-need-a-loss-Function"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Basically we need to have gradients for correcting our weighs, we need to know which direction we need to go</strong></p>
<p>If you dont understand all of these, ckeck khan academy for gradient.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trgts</span>  <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">prds</span>   <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mnist_loss</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">targets</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">predictions</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">trgts</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">prds</span><span class="p">,</span> <span class="n">prds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([0.1000, 0.4000, 0.8000])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mnist_loss</span><span class="p">(</span><span class="n">prds</span><span class="p">,</span><span class="n">trgts</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.4333)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sigmoid">
<a class="anchor" href="#Sigmoid" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sigmoid<a class="anchor-link" href="#Sigmoid"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>We need this for squishing predictions between 0-1</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_function</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">'Sigmoid'</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>update the fuction with the sigmoid thats all.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mnist_loss</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">targets</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">predictions</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="What-are-SGD-and-Mini-Batches">
<a class="anchor" href="#What-are-SGD-and-Mini-Batches" aria-hidden="true"><span class="octicon octicon-link"></span></a>What are SGD and Mini-Batches<a class="anchor-link" href="#What-are-SGD-and-Mini-Batches"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>This explains most of it.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">coll</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="n">dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">coll</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">list</span><span class="p">(</span><span class="n">dl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[tensor([ 0,  2, 10, 13,  8]),
 tensor([11, 12,  4,  1,  5]),
 tensor([ 3, 14,  6,  9,  7])]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>but this is only a list however we neeed a tuple consist of independent and dependent variable.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span><span class="p">))</span>
<span class="n">ds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#26) [(0, 'a'),(1, 'b'),(2, 'c'),(3, 'd'),(4, 'e'),(5, 'f'),(6, 'g'),(7, 'h'),(8, 'i'),(9, 'j')...]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="DataLoader">
<a class="anchor" href="#DataLoader" aria-hidden="true"><span class="octicon octicon-link"></span></a>DataLoader<a class="anchor-link" href="#DataLoader"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>then put it into a Dataloader.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">list</span><span class="p">(</span><span class="n">dl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(tensor([ 1, 23,  9,  8, 24,  2]), ('b', 'x', 'j', 'i', 'y', 'c')),
 (tensor([14, 25, 13, 11, 19,  5]), ('o', 'z', 'n', 'l', 't', 'f')),
 (tensor([ 0, 10,  4,  7, 18, 12]), ('a', 'k', 'e', 'h', 's', 'm')),
 (tensor([ 6, 21, 15, 16, 22,  3]), ('g', 'v', 'p', 'q', 'w', 'd')),
 (tensor([20, 17]), ('u', 'r'))]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>now we have batches and tuples</strong></p>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>all together</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's time to implement the process we saw in &lt;<gradient_descent>&gt;. In code, our process will be implemented something like this for each epoch:&lt;/p&gt;
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">dl</span><span class="p">:</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_func</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">parameters</span> <span class="o">-=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">grad</span> <span class="o">*</span> <span class="n">lr</span>
</pre></div>

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="n">init_params</span><span class="p">((</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">bias</span> <span class="o">=</span> <span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="n">xb</span><span class="p">,</span><span class="n">yb</span> <span class="o">=</span> <span class="n">first</span><span class="p">(</span><span class="n">dl</span><span class="p">)</span>
<span class="n">xb</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">yb</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([256, 784]), torch.Size([256, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">valid_dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">valid_dset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>a small test</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span> <span class="o">=</span> <span class="n">train_x</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">batch</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([4, 784])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<p><strong>predictions</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">linear1</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<span class="n">preds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ 8.0575],
        [14.3841],
        [-3.8017],
        [ 5.1179]], grad_fn=&lt;AddBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>loss</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss</span> <span class="o">=</span> <span class="n">mnist_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">train_y</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
<span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.2461, grad_fn=&lt;MeanBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>gradients</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="n">weights</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">weights</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">bias</span><span class="o">.</span><span class="n">grad</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([784, 1]), tensor(-0.0010), tensor([-0.0069]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>for the step we need a optimizer</strong></p>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>put all into a function except the optimizer.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">calc_grad</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">xb</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">mnist_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calc_grad</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">train_y</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">linear1</span><span class="p">)</span>
<span class="n">weights</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">bias</span><span class="o">.</span><span class="n">grad</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(-0.0021), tensor([-0.0138]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-error">
    <svg class="octicon octicon-alert octicon octicon-alert octicon octicon-alert octicon octicon-alert" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path></svg>
    <strong>Warning: </strong>if you do it twice results are change.
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calc_grad</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">train_y</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">linear1</span><span class="p">)</span>
<span class="n">weights</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">bias</span><span class="o">.</span><span class="n">grad</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(-0.0031), tensor([-0.0207]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">weights</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">zero_</span><span class="p">()</span>
<span class="n">bias</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">zero_</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">train_epoch</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">xb</span><span class="p">,</span><span class="n">yb</span> <span class="ow">in</span> <span class="n">dl</span><span class="p">:</span>
        <span class="n">calc_grad</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">data</span> <span class="o">-=</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">*</span><span class="n">lr</span>
            <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">zero_</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>little conversion to our results, it's important because we need to understand that what our model says about the numbers(three or not three)</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">preds</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span> <span class="o">==</span> <span class="n">train_y</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ True],
        [ True],
        [False],
        [ True]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">batch_accuracy</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">):</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">xb</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">()</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="p">(</span><span class="n">preds</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">==</span> <span class="n">yb</span>
    <span class="k">return</span> <span class="n">correct</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<p><strong>this is training accuracy</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch_accuracy</span><span class="p">(</span><span class="n">linear1</span><span class="p">(</span><span class="n">batch</span><span class="p">),</span> <span class="n">train_y</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.7500)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>this is for validation for all set</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">validate_epoch</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
    <span class="n">accs</span> <span class="o">=</span> <span class="p">[</span><span class="n">batch_accuracy</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">xb</span><span class="p">),</span> <span class="n">yb</span><span class="p">)</span> <span class="k">for</span> <span class="n">xb</span><span class="p">,</span><span class="n">yb</span> <span class="ow">in</span> <span class="n">valid_dl</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">accs</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">validate_epoch</span><span class="p">(</span><span class="n">linear1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.5136</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training">
<a class="anchor" href="#Training" aria-hidden="true"><span class="octicon octicon-link"></span></a>Training<a class="anchor-link" href="#Training"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>one epochs of training</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">weights</span><span class="p">,</span><span class="n">bias</span>
<span class="n">train_epoch</span><span class="p">(</span><span class="n">linear1</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="n">validate_epoch</span><span class="p">(</span><span class="n">linear1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.7121</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>then more</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">train_epoch</span><span class="p">(</span><span class="n">linear1</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">validate_epoch</span><span class="p">(</span><span class="n">linear1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">' '</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.8656 0.9203 0.9457 0.9549 0.9593 0.9623 0.9652 0.9666 0.9681 0.9705 0.9706 0.9711 0.972 0.973 0.9735 0.9735 0.974 0.9745 0.9755 0.9755 </pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Optimizer">
<a class="anchor" href="#Optimizer" aria-hidden="true"><span class="octicon octicon-link"></span></a>Optimizer<a class="anchor-link" href="#Optimizer"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Let's start creating our model with Pytorch instead of our "linear1" function. Pytorch also creates parameters like our init_params function.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">linear_model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">w</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([1, 784]), torch.Size([1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Custom optimizer</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">BasicOptim</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">params</span><span class="p">,</span><span class="n">lr</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lr</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">params</span><span class="p">),</span><span class="n">lr</span>

    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">data</span> <span class="o">-=</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lr</span>

    <span class="k">def</span> <span class="nf">zero_grad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opt</span> <span class="o">=</span> <span class="n">BasicOptim</span><span class="p">(</span><span class="n">linear_model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>new training fuction will be</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">train_epoch</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">xb</span><span class="p">,</span><span class="n">yb</span> <span class="ow">in</span> <span class="n">dl</span><span class="p">:</span>
        <span class="n">calc_grad</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
        <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">validate_epoch</span><span class="p">(</span><span class="n">linear_model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.4078</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">epochs</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
        <span class="n">train_epoch</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">validate_epoch</span><span class="p">(</span><span class="n">model</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">' '</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_model</span><span class="p">(</span><span class="n">linear_model</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.4932 0.8193 0.8418 0.9136 0.9331 0.9477 0.9555 0.9629 0.9658 0.9673 0.9697 0.9717 0.9736 0.9751 0.9761 0.9761 0.9775 0.9775 0.9785 0.9785 </pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Fastai's-SDG-class">
<a class="anchor" href="#Fastai's-SDG-class" aria-hidden="true"><span class="octicon octicon-link"></span></a>Fastai's SDG class<a class="anchor-link" href="#Fastai's-SDG-class"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>instead of using "BasicOptim" class we can use fastai's SGD class</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">linear_model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">SGD</span><span class="p">(</span><span class="n">linear_model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="p">)</span>
<span class="n">train_model</span><span class="p">(</span><span class="n">linear_model</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.4932 0.7808 0.8623 0.9185 0.9365 0.9521 0.9575 0.9638 0.9658 0.9678 0.9707 0.9726 0.9741 0.9751 0.9761 0.9765 0.9775 0.978 0.9785 0.9785 </pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Just remove the "train_model" at this time and use fastai's "Learner.fit" Before using Learner first we need to pass our trainig and validation data into "Dataloaders" not "dataloader"</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Fastai's-Dataloaders">
<a class="anchor" href="#Fastai's-Dataloaders" aria-hidden="true"><span class="octicon octicon-link"></span></a>Fastai's Dataloaders<a class="anchor-link" href="#Fastai's-Dataloaders"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="p">(</span><span class="n">dl</span><span class="p">,</span> <span class="n">valid_dl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">SGD</span><span class="p">,</span>
                <span class="n">loss_func</span><span class="o">=</span><span class="n">mnist_loss</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">batch_accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="FastAi's-Fit">
<a class="anchor" href="#FastAi's-Fit" aria-hidden="true"><span class="octicon octicon-link"></span></a>FastAi's Fit<a class="anchor-link" href="#FastAi's-Fit"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>batch_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.637166</td>
      <td>0.503575</td>
      <td>0.495584</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.562232</td>
      <td>0.139727</td>
      <td>0.900393</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.204552</td>
      <td>0.207935</td>
      <td>0.806183</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.088904</td>
      <td>0.114767</td>
      <td>0.904809</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.046327</td>
      <td>0.081602</td>
      <td>0.930324</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.029754</td>
      <td>0.064530</td>
      <td>0.944553</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.022963</td>
      <td>0.054135</td>
      <td>0.954858</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.019966</td>
      <td>0.047293</td>
      <td>0.961236</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.018464</td>
      <td>0.042515</td>
      <td>0.965162</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.017573</td>
      <td>0.039011</td>
      <td>0.966634</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Adding-a-Nonlinearity">
<a class="anchor" href="#Adding-a-Nonlinearity" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adding a Nonlinearity<a class="anchor-link" href="#Adding-a-Nonlinearity"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>The basic idea is that by using more linear layers, we can have our model do more computation, and therefore model more complex functions. But there's no point just putting one linear layer directly after another one, because when we multiply things together and then add them up multiple times, that could be replaced by multiplying different things together and adding them up just once! That is to say, a series of any number of linear layers in a row can be replaced with a single linear layer with a different set of parameters.</strong> (From Fastbook)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Amazingly enough, it can be mathematically proven that this little function can solve any computable problem to an arbitrarily high level of accuracy, if you can find the right parameters for w1 and w2 and if you make these matrices big enough. For any arbitrarily wiggly function, we can approximate it as a bunch of lines joined together; to make it closer to the wiggly function, we just have to use shorter lines. This is known as the <strong>universal approximation theorem._</strong> The three lines of code that we have here are known as layers. The first and third are known as linear layers, and the second line of code is known variously as a nonlinearity, or activation function.(From Fastbook)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">simple_net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span><span class="mi">30</span><span class="p">),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">simple_net</span><span class="p">,</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">SGD</span><span class="p">,</span>
                <span class="n">loss_func</span><span class="o">=</span><span class="n">mnist_loss</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">batch_accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>batch_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.303284</td>
      <td>0.398378</td>
      <td>0.511776</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.142384</td>
      <td>0.221517</td>
      <td>0.817959</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.079702</td>
      <td>0.112610</td>
      <td>0.917076</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.052855</td>
      <td>0.076474</td>
      <td>0.942100</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.040301</td>
      <td>0.059791</td>
      <td>0.958783</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.033824</td>
      <td>0.050389</td>
      <td>0.964181</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.030075</td>
      <td>0.044483</td>
      <td>0.966143</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.027629</td>
      <td>0.040465</td>
      <td>0.966634</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.025865</td>
      <td>0.037553</td>
      <td>0.969578</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.024499</td>
      <td>0.035336</td>
      <td>0.971541</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.023391</td>
      <td>0.033579</td>
      <td>0.972522</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.022467</td>
      <td>0.032142</td>
      <td>0.973994</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.021679</td>
      <td>0.030936</td>
      <td>0.973994</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.020997</td>
      <td>0.029901</td>
      <td>0.974975</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.020398</td>
      <td>0.028998</td>
      <td>0.974975</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.019869</td>
      <td>0.028198</td>
      <td>0.975957</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.019395</td>
      <td>0.027484</td>
      <td>0.976448</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.018966</td>
      <td>0.026841</td>
      <td>0.976938</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.018577</td>
      <td>0.026259</td>
      <td>0.977429</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.018220</td>
      <td>0.025730</td>
      <td>0.977429</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>20</td>
      <td>0.017892</td>
      <td>0.025244</td>
      <td>0.978410</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>21</td>
      <td>0.017588</td>
      <td>0.024799</td>
      <td>0.979882</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>22</td>
      <td>0.017306</td>
      <td>0.024388</td>
      <td>0.979882</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>23</td>
      <td>0.017042</td>
      <td>0.024008</td>
      <td>0.980373</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>24</td>
      <td>0.016794</td>
      <td>0.023656</td>
      <td>0.980864</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>25</td>
      <td>0.016561</td>
      <td>0.023328</td>
      <td>0.980864</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>26</td>
      <td>0.016341</td>
      <td>0.023022</td>
      <td>0.980864</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>27</td>
      <td>0.016133</td>
      <td>0.022737</td>
      <td>0.981845</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>28</td>
      <td>0.015935</td>
      <td>0.022470</td>
      <td>0.981845</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>29</td>
      <td>0.015746</td>
      <td>0.022221</td>
      <td>0.981845</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>30</td>
      <td>0.015566</td>
      <td>0.021988</td>
      <td>0.982336</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>31</td>
      <td>0.015395</td>
      <td>0.021769</td>
      <td>0.982336</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>32</td>
      <td>0.015231</td>
      <td>0.021565</td>
      <td>0.982826</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>33</td>
      <td>0.015076</td>
      <td>0.021371</td>
      <td>0.982826</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>34</td>
      <td>0.014925</td>
      <td>0.021190</td>
      <td>0.982826</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>35</td>
      <td>0.014782</td>
      <td>0.021018</td>
      <td>0.982826</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>36</td>
      <td>0.014643</td>
      <td>0.020856</td>
      <td>0.982826</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>37</td>
      <td>0.014510</td>
      <td>0.020703</td>
      <td>0.982826</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>38</td>
      <td>0.014382</td>
      <td>0.020558</td>
      <td>0.982826</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>39</td>
      <td>0.014258</td>
      <td>0.020420</td>
      <td>0.982826</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="recorder-is-a-fast-ai-method">
<a class="anchor" href="#recorder-is-a-fast-ai-method" aria-hidden="true"><span class="octicon octicon-link"></span></a>recorder is a fast ai method<a class="anchor-link" href="#recorder-is-a-fast-ai-method"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">itemgot</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Last value</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.982826292514801</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="GOING-DEEPER">
<a class="anchor" href="#GOING-DEEPER" aria-hidden="true"><span class="octicon octicon-link"></span></a>GOING DEEPER<a class="anchor-link" href="#GOING-DEEPER"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>why deeper if it is two and a nonlinear between them is enough</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We already know that a single nonlinearity with two linear layers is enough to approximate any function. So why would we use deeper models? The reason is performance. With a deeper model (that is, one with more layers) we do not need to use as many parameters; it turns out that we can use smaller matrices with more layers, and get better results than we would get with larger matrices, and few layers.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">ImageDataLoaders</span><span class="o">.</span><span class="n">from_folder</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">cnn_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">resnet18</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">loss_func</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.089727</td>
      <td>0.011755</td>
      <td>0.997056</td>
      <td>00:13</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

&lt;/div&gt;
 

</gradient_descent></p>
</div>
</div></div>
</div>


  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="niyazikemer/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/fastbook/2021/07/16/chapter-4.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>My Fastbook Notes</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/niyazikemer" target="_blank" title="niyazikemer"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/niyazi_kemer" target="_blank" title="niyazi_kemer"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
